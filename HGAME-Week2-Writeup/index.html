<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>HGAME-Week2-Writeup - 0wl’s Blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="0wl’s Blog"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="0wl’s Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Week2"><meta property="og:type" content="blog"><meta property="og:title" content="HGAME-Week2-Writeup"><meta property="og:url" content="https://www.0wl.site/HGAME-Week2-Writeup/"><meta property="og:site_name" content="0wl’s Blog"><meta property="og:description" content="Week2"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://www.0wl.site/HGAME-Week2-Writeup/web1(2).png"><meta property="og:image" content="https://www.0wl.site/HGAME-Week2-Writeup/web1(3).png"><meta property="og:image" content="https://www.0wl.site/HGAME-Week2-Writeup/web1(4).png"><meta property="og:image" content="https://www.0wl.site/HGAME-Week2-Writeup/web1.png"><meta property="og:image" content="https://www.0wl.site/HGAME-Week2-Writeup/web(6).png"><meta property="og:image" content="https://www.0wl.site/HGAME-Week2-Writeup/web2(6).png"><meta property="og:image" content="https://www.0wl.site/HGAME-Week2-Writeup/web2(4).png"><meta property="og:image" content="https://www.0wl.site/HGAME-Week2-Writeup/web(2).png"><meta property="og:image" content="https://www.0wl.site/HGAME-Week2-Writeup/web2.png"><meta property="og:image" content="https://www.0wl.site/HGAME-Week2-Writeup/re1(4).png"><meta property="og:image" content="https://www.0wl.site/HGAME-Week2-Writeup/re1.jpg"><meta property="og:image" content="https://www.0wl.site/HGAME-Week2-Writeup/re1(5).png"><meta property="og:image" content="https://www.0wl.site/HGAME-Week2-Writeup/re1(3).png"><meta property="og:image" content="https://www.0wl.site/HGAME-Week2-Writeup/re2(3).png"><meta property="og:image" content="https://www.0wl.site/HGAME-Week2-Writeup/re2.png"><meta property="og:image" content="https://www.0wl.site/HGAME-Week2-Writeup/re2(5).png"><meta property="og:image" content="https://www.0wl.site/HGAME-Week2-Writeup/re2(1).png"><meta property="og:image" content="https://www.0wl.site/HGAME-Week2-Writeup/re2(6).png"><meta property="og:image" content="https://www.0wl.site/HGAME-Week2-Writeup/re2(2).png"><meta property="og:image" content="https://www.0wl.site/HGAME-Week2-Writeup/re3.png"><meta property="og:image" content="https://www.0wl.site/HGAME-Week2-Writeup/crypto2.png"><meta property="og:image" content="https://www.0wl.site/HGAME-Week2-Writeup/crypto3(2).png"><meta property="og:image" content="https://www.0wl.site/HGAME-Week2-Writeup/crypto3.png"><meta property="og:image" content="https://www.0wl.site/HGAME-Week2-Writeup/flag.jpg"><meta property="og:image" content="https://www.0wl.site/HGAME-Week2-Writeup/misc2.png"><meta property="og:image" content="https://www.0wl.site/HGAME-Week2-Writeup/misc2%EF%BC%882%EF%BC%89.png"><meta property="og:image" content="https://www.0wl.site/HGAME-Week2-Writeup/misc2%EF%BC%881%EF%BC%89.png"><meta property="og:image" content="https://www.0wl.site/HGAME-Week2-Writeup/solved.bmp"><meta property="og:image" content="https://www.0wl.site/HGAME-Week2-Writeup/misc3.png"><meta property="og:image" content="https://www.0wl.site/HGAME-Week2-Writeup/hgame.png"><meta property="og:image" content="https://www.0wl.site/HGAME-Week2-Writeup/misc4.png"><meta property="og:image" content="https://www.0wl.site/HGAME-Week2-Writeup/misc4.jpg"><meta property="og:image" content="https://www.0wl.site/HGAME-Week2-Writeup/misc4(1).png"><meta property="article:published_time" content="2021-03-27T06:43:36.000Z"><meta property="article:modified_time" content="2021-11-16T14:53:38.912Z"><meta property="article:author" content="0wl"><meta property="article:tag" content="hgame"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/HGAME-Week2-Writeup/web1(2).png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.0wl.site/HGAME-Week2-Writeup/"},"headline":"0wl’s Blog","image":["https://www.0wl.site/HGAME-Week2-Writeup/web1(2).png","https://www.0wl.site/HGAME-Week2-Writeup/web1(3).png","https://www.0wl.site/HGAME-Week2-Writeup/web1(4).png","https://www.0wl.site/HGAME-Week2-Writeup/web1.png","https://www.0wl.site/HGAME-Week2-Writeup/web(6).png","https://www.0wl.site/HGAME-Week2-Writeup/web2(6).png","https://www.0wl.site/HGAME-Week2-Writeup/web2(4).png","https://www.0wl.site/HGAME-Week2-Writeup/web(2).png","https://www.0wl.site/HGAME-Week2-Writeup/web2.png","https://www.0wl.site/HGAME-Week2-Writeup/re1(4).png","https://www.0wl.site/HGAME-Week2-Writeup/re1.jpg","https://www.0wl.site/HGAME-Week2-Writeup/re1(5).png","https://www.0wl.site/HGAME-Week2-Writeup/re1(3).png","https://www.0wl.site/HGAME-Week2-Writeup/re2(3).png","https://www.0wl.site/HGAME-Week2-Writeup/re2.png","https://www.0wl.site/HGAME-Week2-Writeup/re2(5).png","https://www.0wl.site/HGAME-Week2-Writeup/re2(1).png","https://www.0wl.site/HGAME-Week2-Writeup/re2(6).png","https://www.0wl.site/HGAME-Week2-Writeup/re2(2).png","https://www.0wl.site/HGAME-Week2-Writeup/re3.png","https://www.0wl.site/HGAME-Week2-Writeup/crypto2.png","https://www.0wl.site/HGAME-Week2-Writeup/crypto3(2).png","https://www.0wl.site/HGAME-Week2-Writeup/crypto3.png","https://www.0wl.site/HGAME-Week2-Writeup/flag.jpg","https://www.0wl.site/HGAME-Week2-Writeup/misc2.png","https://www.0wl.site/HGAME-Week2-Writeup/misc2%EF%BC%882%EF%BC%89.png","https://www.0wl.site/HGAME-Week2-Writeup/misc2%EF%BC%881%EF%BC%89.png","https://www.0wl.site/HGAME-Week2-Writeup/misc3.png","https://www.0wl.site/HGAME-Week2-Writeup/hgame.png","https://www.0wl.site/HGAME-Week2-Writeup/misc4.png","https://www.0wl.site/HGAME-Week2-Writeup/misc4.jpg","https://www.0wl.site/HGAME-Week2-Writeup/misc4(1).png"],"datePublished":"2021-03-27T06:43:36.000Z","dateModified":"2021-11-16T14:53:38.912Z","author":{"@type":"Person","name":"0wl"},"description":"Week2"}</script><link rel="canonical" href="https://www.0wl.site/HGAME-Week2-Writeup/"><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/9.12.0/styles/github-gist.min.css"><link rel="stylesheet"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><script>var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "//hm.baidu.com/hm.js?50fcb826e7ea18041d7e21129d7347e5";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();</script><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/cookieconsent/3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/pace/1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="0wl’s Blog" type="application/atom+xml">
</head><body class="is-3-column"><script type="text/javascript" src="/js/imaegoo/night.js"></script><canvas id="universe"></canvas><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img class="logo-img" src="/" alt="0wl’s Blog" height="28"><img class="logo-img-dark" src="/" alt="0wl’s Blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">首页</a><a class="navbar-item" href="/archives/">时间轴</a><a class="navbar-item" href="/categories/">分类</a><a class="navbar-item" href="/tags/">标签</a><a class="navbar-item" href="/about/">关于</a><a class="navbar-item" href="/friends/">友链</a></div><div class="navbar-end"><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i><span>  目录</span></a><a class="navbar-item night" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/0wl-alt"><i class="fab fa-github"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2021-03-27T06:43:36.000Z" title="2021/3/27 下午2:43:36">2021-03-27</time>发表</span><span class="level-item"><time dateTime="2021-11-16T14:53:38.912Z" title="2021/11/16 下午10:53:38">2021-11-16</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/Hgame2021/">Hgame2021</a></span><span class="level-item">13 分钟读完 (大约1973个字)</span><span class="level-item leancloud_visitors" id="/HGAME-Week2-Writeup/" data-flag-title="HGAME-Week2-Writeup"><i class="far fa-eye"></i>&nbsp;&nbsp;<span id="twikoo_visitors"><i class="fa fa-spinner fa-spin"></i></span>次访问</span></div></div><h1 class="title is-3 is-size-4-mobile">HGAME-Week2-Writeup</h1><div class="content"><article class="message is-info"><div class="message-body">
<p>Week2</p>
</div></article>

<span id="more"></span>

<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="1-LazyDogR4U"><a href="#1-LazyDogR4U" class="headerlink" title="1.LazyDogR4U"></a>1.LazyDogR4U</h3><p>​        首先打开题目地址</p>
<img src="/HGAME-Week2-Writeup/web1(2).png" class="">

<p>​        根据题目给的hint，在地址栏后面加上 <strong>/<a target="_blank" rel="noopener" href="http://www.zip/">www.zip</a></strong> 获得网页源码</p>
<p>​        接着打开 lazy.php 和 flag.php 这两个php文件，再根据<strong>变量覆盖</strong>的提示找到漏洞点</p>
<img src="/HGAME-Week2-Writeup/web1(3).png" class="">

<p>​        这里划线处的两个$符号容易导致变量覆盖，那么根据 flag.php 中得到flag的条件就可以进行构造，相当于：          $_SESSSION[username]=admin</p>
<img src="/HGAME-Week2-Writeup/web1(4).png" class="">

<p>​        双写SESSION是因为上面str_replace的过滤</p>
<img src="/HGAME-Week2-Writeup/web1.png" class="">

<p>​        得到flag</p>
<h3 id="2-Post-to-zuckonit"><a href="#2-Post-to-zuckonit" class="headerlink" title="2.Post to zuckonit"></a>2.Post to zuckonit</h3><p>​        <img src="/HGAME-Week2-Writeup/web(6).png" class=""></p>
<p>​        点开后发现是留言板，题目也很明确的指出是<strong>xss</strong>，那么就先尝试输入 script，iframe，image</p>
<p>​        输入后发现不管大小写 script 都会被过滤掉，小写的 iframe 会被过滤，image则不会被过滤</p>
<p>​        之后尝试输入 img src=1 onerror = alert(1) ，让错误的图片导致弹窗</p>
<img src="/HGAME-Week2-Writeup/web2(6).png" class="">

<p>​        输出了这么个东西，把这个输入再 post 就会弹窗，成功弹窗之后就是找一个 xss 平台来接受 cookie 信息</p>
<img src="/HGAME-Week2-Writeup/web2(4).png" class="">

<p>​        根据之前的规律 post 平台给的语句，并用脚本得出 md5 验证码提交，接收到 cookie 信息</p>
<p>脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">md5</span>(<span class="params">s</span>):</span></span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(s.encode()).hexdigest()</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_code</span>():</span></span><br><span class="line">    code = <span class="string">&#x27;XXXXXX&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10000000</span>, <span class="number">99999999</span>):   <span class="comment">#8位md5</span></span><br><span class="line">        <span class="keyword">if</span> md5(<span class="built_in">str</span>(i)).startswith(code):</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">str</span>(i)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(get_code())</span><br></pre></td></tr></table></figure>

<img src="/HGAME-Week2-Writeup/web(2).png" class="">

<p>​        接着就伪造 admin cookie 得到flag</p>
<img src="/HGAME-Week2-Writeup/web2.png" class="">

<h2 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h2><h3 id="1-ezApk"><a href="#1-ezApk" class="headerlink" title="1.ezApk"></a>1.ezApk</h3><p>​        <strong>安卓逆向</strong>，用 jadx 反编译为 java，找到 onClick 事件</p>
<img src="/HGAME-Week2-Writeup/re1(4).png" class="">

<p>​        这条判断语句是关键，在资源文件中找到加密后的 flag 和 key</p>
<img src="/HGAME-Week2-Writeup/re1.jpg" class="">

<p>​        s函数用来加密输入的字符串，转到s函数分析</p>
<img src="/HGAME-Week2-Writeup/re1(5).png" class="">

<p>​        仔细分析后得知是<strong>AES CBC模式</strong>加密，密钥是之前的key经过<strong>sha-256</strong>加密得到的，iv向量则是key经过<strong>MD5</strong>加密得到的，最后将加密结果再进行一次 <strong>base64</strong> 加密得到之前的 flag</p>
<p>​        尝试用在线网站解密，但是网站一般只支持 16 位 iv 值解密，没有别的办法只能东拼西凑写出 java 脚本来解密</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.company;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.Cipher;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.IvParameterSpec;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.SecretKeySpec;</span><br><span class="line"><span class="keyword">import</span> java.security.MessageDigest;</span><br><span class="line"><span class="keyword">import</span> java.security.NoSuchAlgorithmException;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//md5,sha-256加密</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">byte</span>[] t(String str, String str2) &#123;</span><br><span class="line">        MessageDigest instance = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            instance = MessageDigest.getInstance(str);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchAlgorithmException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">byte</span>[] bytes = str2.getBytes();</span><br><span class="line">        <span class="keyword">byte</span>[] digest = instance.digest(bytes);</span><br><span class="line">        <span class="keyword">return</span> digest;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//解密</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">desEncrypt</span><span class="params">(String data, <span class="keyword">byte</span>[] key)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">byte</span>[] ivString = t(<span class="string">&quot;MD5&quot;</span>,<span class="string">&quot;A_HIDDEN_KEY&quot;</span>); <span class="comment">//iv向量</span></span><br><span class="line">        <span class="keyword">byte</span>[] iv = ivString;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">byte</span>[] encryp = Base64.getDecoder().decode(data);</span><br><span class="line">            Cipher cipher =           Cipher.getInstance(<span class="string">&quot;AES/CBC/PKCS7Padding&quot;</span>);</span><br><span class="line">            SecretKeySpec keySpec = <span class="keyword">new</span> SecretKeySpec(key, <span class="string">&quot;AES&quot;</span>);</span><br><span class="line">            IvParameterSpec ivSpec = <span class="keyword">new</span> IvParameterSpec(iv);</span><br><span class="line">            cipher.init(Cipher.DECRYPT_MODE, keySpec, ivSpec);</span><br><span class="line">            <span class="keyword">byte</span>[] original = cipher.doFinal(encryp);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> String(original);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String data = <span class="string">&quot;EEB23sI1Wd9Gvhvk1sgWyQZhjilnYwCi5au1guzOaIg5dMAj9qPA7lnIyVoPSdRY&quot;</span>;     <span class="comment">//密文</span></span><br><span class="line">        <span class="keyword">byte</span>[] key =t(<span class="string">&quot;SHA-256&quot;</span>,<span class="string">&quot;A_HIDDEN_KEY&quot;</span>);  <span class="comment">//密钥</span></span><br><span class="line">        String desencrypt = desEncrypt(data, key);</span><br><span class="line">        System.out.println(<span class="string">&quot;解密后:&quot;</span>+desencrypt);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​        因为要用到的是AES 256位解密，而 java 本身只支持 128位 AES 解密，所以就要做其他的一些配置才能解密</p>
<img src="/HGAME-Week2-Writeup/re1(3).png" class="">

<h3 id="2-helloRe2"><a href="#2-helloRe2" class="headerlink" title="2.helloRe2"></a>2.helloRe2</h3><p>​        拖进 IDA 分析，乍一看结构有点复杂，password1 的判断在后半部分，而password2 的判断在前半部分，先分析 password1</p>
<img src="/HGAME-Week2-Writeup/re2(3).png" class="">

<p>​        关键部分是这条判断，判断输入的password长度和 password 经过一系列操作后的结果，用 ollydbg 调试并不断猜测，得知这么一系列操作就是判断输入的字符串是否是给出的密文的逆序</p>
<p>​        之后再分析 pwd2 </p>
<img src="/HGAME-Week2-Writeup/re2.png" class="">

<p>​        应该又是AES CBC 模式加密，找到 iv 和 密钥，密钥是pwd1经过异或得到，密文是已经给出密文的逆序</p>
<p>![](D:\HGAME2021\HGAME week2\re2(4).png)</p>
<img src="/HGAME-Week2-Writeup/re2(5).png" class="">

<p>​        解密就用上一题的脚本</p>
<img src="/HGAME-Week2-Writeup/re2(1).png" class="">

<img src="/HGAME-Week2-Writeup/re2(6).png" class="">

<p>​        这里看着像是两次加密，但其实只有一次</p>
<img src="/HGAME-Week2-Writeup/re2(2).png" class="">

<h3 id="3-fake-debugger-beta"><a href="#3-fake-debugger-beta" class="headerlink" title="3.fake_debugger beta"></a>3.fake_debugger beta</h3><p>​        nc题目地址，发现只有在 ebx 经过一次转换后与 eax 相等才能继续调试，之后不断调试发现</p>
<img src="/HGAME-Week2-Writeup/re3.png" class="">

<p>​        转换前的 ebx 与 eax 异或后就是 flag 中的字符，那就一个个调试下来得到 flag</p>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="1-gcd-or-more"><a href="#1-gcd-or-more" class="headerlink" title="1.gcd or more?"></a>1.gcd or more?</h3><p>​        <img src="/HGAME-Week2-Writeup/crypto2.png" class=""></p>
<p>​        看着像是RSA，但是e = 2。百度后查到低指数爆破，之后又看到Rabin算法，特征是e = 2 ，那么就用这个脚本解题</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">e = <span class="number">2</span></span><br><span class="line">p = <span class="number">85228565021128901853314934583129083441989045225022541298550570449389839609019</span></span><br><span class="line">q = <span class="number">111614714641364911312915294479850549131835378046002423977989457843071188836271</span></span><br><span class="line">n = p * q</span><br><span class="line">c = <span class="number">7665003682830666456193894491015989641647854826647177873141984107202099081475984827806007287830472899616818080907276606744467453445908923054975393623509539</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#c= int(open(&#x27;./flag.enc&#x27;,&#x27;rb&#x27;).read().encode(&#x27;hex&#x27;),16)</span></span><br><span class="line">mp = <span class="built_in">pow</span>(c, (p + <span class="number">1</span>) // <span class="number">4</span>, p)</span><br><span class="line">mq = <span class="built_in">pow</span>(c, (q + <span class="number">1</span>) // <span class="number">4</span>, q)</span><br><span class="line">yp = gmpy2.invert(p, q)</span><br><span class="line">yq = gmpy2.invert(q, p)</span><br><span class="line">r = (yp * p * mq + yq * q * mp) % n</span><br><span class="line">rr = n - r</span><br><span class="line">s = (yp * p * mq - yq * q * mp) % n</span><br><span class="line">ss = n - s</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(r)))</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(rr)))</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(s)))</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(ss)))</span><br></pre></td></tr></table></figure>

<h3 id="2-WhitegiveRSA"><a href="#2-WhitegiveRSA" class="headerlink" title="2.WhitegiveRSA"></a>2.WhitegiveRSA</h3><p>​        <img src="/HGAME-Week2-Writeup/crypto3(2).png" class=""></p>
<p>​        已知N，那就拿到在线网站里分解出大素数 q 和 p，剩下来都已知就用脚本解密</p>
<img src="/HGAME-Week2-Writeup/crypto3.png" class="">

<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="1-Tools"><a href="#1-Tools" class="headerlink" title="1.Tools"></a>1.Tools</h3><p>​        下载解压得到一个压缩包和一张图片，根据题目的 tools 和压缩包名 f5 尝试用 f5 工具破解压缩包密码，破解所需的密码在图片的详细信息中</p>
<p>​        打开加密压缩包后发现一部分二维码和压缩包，接着就是像之前那样找到压缩包名里的工具解密，最终集齐4张二维码碎片，用win10自带的画图工具拼合，扫码得flag</p>
<img src="/HGAME-Week2-Writeup/flag.jpg" class="">

<h3 id="2-Telegraph：1601-6639-3459-3134-0892"><a href="#2-Telegraph：1601-6639-3459-3134-0892" class="headerlink" title="2.Telegraph：1601 6639 3459 3134 0892"></a>2.Telegraph：1601 6639 3459 3134 0892</h3><p>​        题目为音频隐写，又提到听着反胃，于是猜测是<strong>摩斯电码</strong>。听了之后，中间有一段嘀嗒声，这一段就是需要摩斯解密的部分，接着把音频拖到 <strong>Audacity</strong> 里面分析</p>
<p>​        首先看一下频谱图</p>
<img src="/HGAME-Week2-Writeup/misc2.png" class="">

<p>​        得到<strong>850hz</strong>的提示，之后尝试翻译摩斯电码，发现中间有一段无法辨认就想到要滤波，用的是上面的提示</p>
<img src="/HGAME-Week2-Writeup/misc2%EF%BC%882%EF%BC%89.png" class="">

<p>​        窄的是**.**   宽的是**-**  ，翻译后解密就得到flag</p>
<img src="/HGAME-Week2-Writeup/misc2%EF%BC%881%EF%BC%89.png" class="">

<h3 id="3-Hallucigenia"><a href="#3-Hallucigenia" class="headerlink" title="3.Hallucigenia"></a>3.Hallucigenia</h3><p>​        只给了一张图，那么就先用 Stegsolve 左右调一下得到二维码</p>
<img src="/HGAME-Week2-Writeup/solved.bmp" class="">

<p>​        扫码得到一串 base64 解码发现最后是 GNP ，根据题目中 **“我们不仅弄错了他的上下，还颠倒了它的左右。” **逆序处理后粘贴到winhex保存为图片</p>
<img src="/HGAME-Week2-Writeup/misc3.png" class="">

<p>​        发现又是上下左右颠倒，倒回来就得flag</p>
<img src="/HGAME-Week2-Writeup/hgame.png" class="">

<h3 id="4-DNS"><a href="#4-DNS" class="headerlink" title="4.DNS"></a>4.DNS</h3><p>​        流量包分析，筛选 dns 得到一串域名并访问</p>
<img src="/HGAME-Week2-Writeup/misc4.png" class="">

<p>​        抓包得</p>
<img src="/HGAME-Week2-Writeup/misc4.jpg" class="">

<p>​        查一下 SPF 知道是一种 <strong>dns 记录</strong>，那就用在线网站查一下dns记录，得到flag</p>
<img src="/HGAME-Week2-Writeup/misc4(1).png" class="">



<h2 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h2><p>​        这周比较摸鱼，web 能做出两道是因为给了具体的考点，参照往年 writeup 一点点做下来。   re 做了很久，因为之前没有接触过 apk 逆向，对 aes 加密也不太了解，最后能全部做出来真是太好了，逆向的时候果然是要抓重点，解完题后才发现其实挺简单的。 密码学是真不太行，这周 pwn 也基本没看，Misc 倒是做的挺顺畅的，下周要试着把之前的知识捡起来了</p>
</div><div class="article-licensing box"><div class="licensing-title"><p>HGAME-Week2-Writeup</p><p><a href="https://www.0wl.site/HGAME-Week2-Writeup/">https://www.0wl.site/HGAME-Week2-Writeup/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>0wl</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2021-03-27</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2021-11-16</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="icon" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/hgame/">hgame</a></div><div class="a2a_kit a2a_kit_size_32 a2a_default_style"><a class="a2a_dd" target="_blank" rel="noopener" href="https://www.addtoany.com/share"></a><a class="a2a_button_facebook"></a><a class="a2a_button_twitter"></a><a class="a2a_button_telegram"></a><a class="a2a_button_whatsapp"></a><a class="a2a_button_reddit"></a></div><script src="https://static.addtoany.com/menu/page.js" defer></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">喜欢这篇文章？打赏一下作者吧</h3><div class="buttons is-centered"><a class="button donate" href="/" target="_blank" rel="noopener" data-type="afdian"><span class="icon is-small"><i class="fas fa-charging-station"></i></span><span>爱发电</span></a><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>支付宝</span><span class="qrcode"><img src="/img/alipay.jpg" alt="支付宝"></span></a><a class="button donate" href="/" target="_blank" rel="noopener" data-type="buymeacoffee"><span class="icon is-small"><i class="fas fa-coffee"></i></span><span>送我杯咖啡</span></a><a class="button donate" href="/" target="_blank" rel="noopener" data-type="patreon"><span class="icon is-small"><i class="fab fa-patreon"></i></span><span>Patreon</span></a><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>微信</span><span class="qrcode"><img src="/img/wechat.png" alt="微信"></span></a></div></div></div><div class="card"><nav class="post-navigation mt-4 level is-mobile card-content"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/HGAME-Week3-Writeup/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">HGAME-Week3-Writeup</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/HGAME-Week1-writeup/"><span class="level-item">HGAME-Week1-writeup</span><i class="level-item fas fa-chevron-right"></i></a></div></nav></div><div class="card"><div class="card-content"><h3 class="title is-5">评论</h3><div class="content twikoo" id="twikoo"></div><script src="https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js"></script><script>twikoo.init({
      envId: 'blog-9gu02qis60845ab5'
    });</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/img/avatar.jpg" alt="0wl"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">0wl</p><p class="is-size-6 is-block">HDU / CTFer / Re</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Hangzhou, China</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">18</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">1</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">14</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/0wl-alt" target="_blank" rel="noopener" id="widget-follow">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/0wl-alt"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/atom.xml"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="level is-mobile" href="#Web"><span class="level-left"><span class="level-item">Web</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-LazyDogR4U"><span class="level-left"><span class="level-item">1.LazyDogR4U</span></span></a></li><li><a class="level is-mobile" href="#2-Post-to-zuckonit"><span class="level-left"><span class="level-item">2.Post to zuckonit</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Re"><span class="level-left"><span class="level-item">Re</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-ezApk"><span class="level-left"><span class="level-item">1.ezApk</span></span></a></li><li><a class="level is-mobile" href="#2-helloRe2"><span class="level-left"><span class="level-item">2.helloRe2</span></span></a></li><li><a class="level is-mobile" href="#3-fake-debugger-beta"><span class="level-left"><span class="level-item">3.fake_debugger beta</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Crypto"><span class="level-left"><span class="level-item">Crypto</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-gcd-or-more"><span class="level-left"><span class="level-item">1.gcd or more?</span></span></a></li><li><a class="level is-mobile" href="#2-WhitegiveRSA"><span class="level-left"><span class="level-item">2.WhitegiveRSA</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Misc"><span class="level-left"><span class="level-item">Misc</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-Tools"><span class="level-left"><span class="level-item">1.Tools</span></span></a></li><li><a class="level is-mobile" href="#2-Telegraph：1601-6639-3459-3134-0892"><span class="level-left"><span class="level-item">2.Telegraph：1601 6639 3459 3134 0892</span></span></a></li><li><a class="level is-mobile" href="#3-Hallucigenia"><span class="level-left"><span class="level-item">3.Hallucigenia</span></span></a></li><li><a class="level is-mobile" href="#4-DNS"><span class="level-left"><span class="level-item">4.DNS</span></span></a></li></ul></li><li><a class="level is-mobile" href="#总结："><span class="level-left"><span class="level-item">总结：</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/MFC/"><span class="tag">MFC</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/gdb/"><span class="tag">gdb</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/hgame/"><span class="tag">hgame</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/idapython/"><span class="tag">idapython</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pwn/"><span class="tag">pwn</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/qemu/"><span class="tag">qemu</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/re/"><span class="tag">re</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/riscv/"><span class="tag">riscv</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ruby/"><span class="tag">ruby</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/upx/"><span class="tag">upx</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/windows/"><span class="tag">windows</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/wp/"><span class="tag">wp</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/wp-pwn/"><span class="tag">wp,pwn</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8F%8D%E8%B0%83%E8%AF%95/"><span class="tag">反调试</span><span class="tag">1</span></a></div></div></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img class="logo-img" src="/" alt="0wl’s Blog" height="28"><img class="logo-img-dark" src="/" alt="0wl’s Blog" height="28"></a><p class="is-size-7"><span>&copy; 2022 0wl</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/imaegoo/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">共<span id="busuanzi_value_site_uv">0</span>个访客</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" defer></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script>if (typeof 0 !== 'undefined' 
            && true == true) {
            $(document).ready(function () {
                var int = setInterval(fixCount, 100);
                var busuanziSiteOffset = parseInt(0);
                function fixCount() {
                    if ($("#busuanzi_container_site_uv").css("display") != "none" && parseInt($("#busuanzi_value_site_uv").html()) > 0) {
                        clearInterval(int);
                        $("#busuanzi_value_site_uv").html(parseInt($("#busuanzi_value_site_uv").html()) + busuanziSiteOffset);
                    }
                }
            });
        }</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/cookieconsent/3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用 Cookie，以启用评论系统和分析功能。",
          dismiss: "知道了",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/js/lightgallery.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><div class="searchbox-pinyin"><label class="checkbox"><input id="search-by-pinyin" type="checkbox" checked="checked"><span> 拼音检索</span></label></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/imaegoo/pinyin.js" defer></script><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script><script type="text/javascript" src="/js/imaegoo/imaegoo.js"></script><script type="text/javascript" src="/js/imaegoo/universe.js"></script><script type="text/javascript" src="/js/live2d/autoload.js"></script></body></html>